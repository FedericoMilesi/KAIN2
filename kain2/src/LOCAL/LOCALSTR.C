#include "../CORE.H"
#include "LOCALSTR.H"
#include "../LOAD3D.H"
#include "../VOICEXA.H"

#include <stddef.h>

static struct LocalizationHeader* LocalizationTable; // offset 0x800CF994

static char** LocalStrings; // offset 0x800CF998

// autogenerated function stub: 
// enum language_t /*$ra*/ localstr_get_language()
enum language_t localstr_get_language()
{ // line 50, offset 0x800b7978
	/* begin block 1 */
		// Start line: 100
	/* end block 1 */
	// End Line: 101

	/* begin block 2 */
		// Start line: 101
	/* end block 2 */
	// End Line: 102

	return (language_t)0;
}

void localstr_set_language(enum language_t lang)
{ 
	int i;

#if defined(PSXPC_VERSION) && defined(NO_CD)
	LocalizationTable = (struct LocalizationHeader*)LOAD_ReadFileFromCD("LOCALS.TBL", 6);
#else
	LocalizationTable = (struct LocalizationHeader*)LOAD_ReadFileFromCD("\\LOCALS.TBL;1", 6);
#endif

	if (LocalizationTable != NULL)
	{
		LocalStrings = (char**)LocalizationTable + 4;
		voiceList = (XAVoiceListEntry*)(char*)(LocalizationTable + LocalizationTable->XATableOffset);

		if (LocalizationTable->numStrings > 0)
		{
			for (i = 0; i < LocalizationTable->numStrings; i++)
			{
				LocalStrings[i] = LocalStrings[i] + (unsigned int)LocalizationTable;
			}
		}
		the_language = LocalizationTable->language;
	}
}

char * localstr_get(enum localstr_t id)
{
	static char BlankStr[2] = { 0x2E, 0x0 };

	if (LocalStrings == NULL)
	{
		return &BlankStr[0];
	}
	else
	{
		return LocalStrings[id];
	}
}




