#include "../core.H"

struct _MonsterState monstate_tbl[] =
{
	MON_BirthEntry, MON_Birth,
	MON_PursueEntry, MON_Pursue,
	MON_IdleEntry, MON_Idle,
	MON_MissileHitEntry, MON_MissileHit,
	MON_FallEntry, MON_Fall,
	MON_WanderEntry, MON_Wander,
	MON_AttackEntry, MON_Attack,
	MON_ImpaleDeathEntry, MON_ImpaleDeath,
	MON_HitEntry, MON_Hit,
	MON_StunnedEntry, MON_Stunned,
	MON_GrabbedEntry, MON_Grabbed,
	MON_ThrownEntry, MON_Thrown,
	MON_ImpactEntry, MON_Impact,
	MON_CombatEntry, MON_Combat,
	MON_BreakHoldEntry, MON_BreakHold,
	MON_LandOnFeetEntry, MON_LandOnFeet,
	MON_GeneralDeathEntry, MON_GeneralDeath,
	MON_EnvironmentDamageEntry, MON_EnvironmentDamage,
	MON_LandInWaterEntry, MON_LandInWater,
	MON_FleeEntry, MON_Flee,
	MON_HideEntry, MON_Hide,
	MON_SurpriseAttackEntry, MON_SurpriseAttack,
	MON_ParryEntry, MON_Parry,
	MON_DeadEntry, MON_Dead,
	MON_SurprisedEntry, MON_Surprised,
	MON_NoticeEntry, MON_Notice,
	MON_PupateEntry, MON_Pupate,
	MON_EmbraceEntry, MON_Embrace,
	MON_ProjectileEntry, MON_Projectile,
	MON_TerrainImpaleDeathEntry, MON_TerrainImpaleDeath,
	MON_PetrifiedEntry, MON_Petrified
};

struct _MonsterFunctionTable mondef_tbl =
{
	MON_DefaultInit,
	MON_CleanUp,
	MON_DamageEffect,
	MonsterQuery,
	MonsterMessage, 0,
	__DATE__
};

struct MONTABLE_207fake // hashcode: 0x35A35A66 (dec: 899897958)
{
	long whatAmI; // size=0, offset=0
	struct _MonsterFunctionTable* table; // size=32, offset=4
};

struct MONTABLE_207fake mon_tables[] =
{
	//{4,        SOUL_FunctionTable},
	//{0x802,    SLUAGH_FunctionTable},
	//{0x1002,   VWRAITH_FunctionTable },
	//{0x2008,   WORSHIP_FunctionTable},
	//{0x8008,   HUMAN_FunctionTable},
	{0x4008,   &HUNTER_FunctionTable},
	//{0x42,     SKINNER_FunctionTable},
	//{0x82,     ALUKA_FunctionTable},
	//{0x102,    WALLCR_FunctionTable},
	//{0x10002,  KAIN_FunctionTable},
	//{0x10042,  SKINBOS_FunctionTable},
	//{0x10202,  RONINBSS_FunctionTable},
	//{0x10082,  ALUKABSS_FunctionTable},
	//{0x10102,  WALBOSS_FunctionTable},
	//{0x410002, WALBOSB_FunctionTable},
	{0}
};

// autogenerated function stub: 
// void /*$ra*/ MONTABLE_SetupTablePointer(struct Object *object /*$a0*/)
void MONTABLE_SetupTablePointer(struct Object *object)
{ // line 376, offset 0x8008ce88
	int v1; // esi
	struct MONTABLE_207fake* v2; // ecx
	struct MONTABLE_207fake* v3; // eax
	int whatAmI; // edi

	v1 = *((DWORD*)object->data + 4);
	if (mon_tables[0].whatAmI)
	{
		v2 = mon_tables;
		v3 = mon_tables;
		do
		{
			if (v1 == v2->whatAmI)
				object->relocModule = v3->table;
			whatAmI = v3[1].whatAmI;
			v2 = ++v3;
		} while (whatAmI);
	}
}

// autogenerated function stub: 
// struct _MonsterState * /*$ra*/ MONTABLE_GetStateFuncs(struct _Instance *instance /*$a0*/, int state /*$a1*/)
struct _MonsterState * MONTABLE_GetStateFuncs(struct _Instance *instance, int state)
{ // line 392, offset 0x8008ced8
	struct _MonsterFunctionTable* relocModule; // eax
	struct _MonsterStateChoice* stateFuncs; // ecx
	int stat; // eax

	relocModule = (struct _MonsterFunctionTable*)instance->object->relocModule;
	if (!relocModule)
		return &monstate_tbl[state];
	stateFuncs = relocModule->stateFuncs;
	stat = stateFuncs->state;
	if (stateFuncs->state == -1)
		return &monstate_tbl[state];
	while (state != stat)
	{
		stat = stateFuncs[1].state;
		++stateFuncs;
		if (stat == -1)
			return &monstate_tbl[state];
	}
	return &stateFuncs->functions;
}


// autogenerated function stub: 
// TDRFuncPtr_MONTABLE_GetDamageEffectFunc /*$ra*/ MONTABLE_GetDamageEffectFunc(struct _Instance *instance /*$a0*/)
TDRFuncPtr_MONTABLE_GetDamageEffectFunc MONTABLE_GetDamageEffectFunc(struct _Instance *instance)
{ // line 408, offset 0x8008cf48
	void* relocModule; // eax
	TDRFuncPtr_MONTABLE_GetDamageEffectFunc result; // eax

	relocModule = instance->object->relocModule;
	if (!relocModule)
		return (TDRFuncPtr_MONTABLE_GetDamageEffectFunc)mondef_tbl.damageEffectFunc;
	result = (TDRFuncPtr_MONTABLE_GetDamageEffectFunc) * ((DWORD*)relocModule + 2);
	if (!result)
		return (TDRFuncPtr_MONTABLE_GetDamageEffectFunc)mondef_tbl.damageEffectFunc;
	return result;
}

// autogenerated function stub: 
// TDRFuncPtr_MONTABLE_GetInitFunc /*$ra*/ MONTABLE_GetInitFunc(struct _Instance *instance /*$a0*/)
TDRFuncPtr_MONTABLE_GetInitFunc MONTABLE_GetInitFunc(struct _Instance *instance)
{ // line 418, offset 0x8008cf7c
	TDRFuncPtr_MONTABLE_GetInitFunc* relocModule; // eax
	TDRFuncPtr_MONTABLE_GetInitFunc result; // eax

	relocModule = (TDRFuncPtr_MONTABLE_GetInitFunc*)instance->object->relocModule;
	if (!relocModule)
		return (TDRFuncPtr_MONTABLE_GetInitFunc)mondef_tbl.initFunc;
	result = *relocModule;
	if (!result)
		return (TDRFuncPtr_MONTABLE_GetInitFunc)mondef_tbl.initFunc;
	return result;
}


// autogenerated function stub: 
// TDRFuncPtr_MONTABLE_GetCleanUpFunc /*$ra*/ MONTABLE_GetCleanUpFunc(struct _Instance *instance /*$a0*/)
TDRFuncPtr_MONTABLE_GetCleanUpFunc MONTABLE_GetCleanUpFunc(struct _Instance *instance)
{ // line 428, offset 0x8008cfb0
	struct _MonsterFunctionTable* relocModule; // eax
	TDRFuncPtr_MONTABLE_GetCleanUpFunc result; // eax

	relocModule = (struct _MonsterFunctionTable*)instance->object->relocModule;
	if (!relocModule)
		return (TDRFuncPtr_MONTABLE_GetCleanUpFunc)mondef_tbl.cleanUpFunc;
	result = (TDRFuncPtr_MONTABLE_GetCleanUpFunc)relocModule->cleanUpFunc;
	if (!result)
		return (TDRFuncPtr_MONTABLE_GetCleanUpFunc)mondef_tbl.cleanUpFunc;
	return result;
}


// autogenerated function stub: 
// void /*$ra*/ MONTABLE_SetQueryFunc(struct _Instance *instance /*$a0*/)
void MONTABLE_SetQueryFunc(struct _Instance *instance)
{ // line 438, offset 0x8008cfe4
	struct _MonsterFunctionTable* relocModule; // eax
	unsigned int(* v2)(struct _Instance* instance, struct evFXHitData* data); // eax

	relocModule = (struct _MonsterFunctionTable*)instance->object->relocModule;
	if (relocModule)
	{
		v2 = relocModule->queryFunc;
		if (v2)
			instance->queryFunc = v2;
	}
}


// autogenerated function stub: 
// void /*$ra*/ MONTABLE_SetMessageFunc(struct _Instance *instance /*$a0*/)
void MONTABLE_SetMessageFunc(struct _Instance *instance)
{ // line 446, offset 0x8008d018
	struct _MonsterFunctionTable* relocModule; // eax
	void(*v2)(struct _Instance* instance, unsigned int message, unsigned int data); // eax

	relocModule = (struct _MonsterFunctionTable*)instance->object->relocModule;
	if (relocModule)
	{
		v2 = relocModule->messageFunc;
		if (v2)
			instance->messageFunc = v2;
	}
}




