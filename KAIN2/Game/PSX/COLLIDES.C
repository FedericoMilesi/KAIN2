#include "COLLIDES.H"

#include "DRAWS.H"

short ecostable[] = {
  0x0000,0x0006,0x000d,0x0013,0x0019,0x001f,0x0026,0x002c,0x0032,0x0039,0x003f,0x0045,0x004b,0x0052,0x0058,0x005e,
  0x0065,0x006b,0x0071,0x0077,0x007e,0x0084,0x008a,0x0090,0x0097,0x009d,0x00a3,0x00aa,0x00b0,0x00b6,0x00bc,0x00c3,
  0x00c9,0x00cf,0x00d6,0x00dc,0x00e2,0x00e8,0x00ef,0x00f5,0x00fb,0x0101,0x0108,0x010e,0x0114,0x011b,0x0121,0x0127,
  0x012d,0x0134,0x013a,0x0140,0x0146,0x014d,0x0153,0x0159,0x015f,0x0166,0x016c,0x0172,0x0178,0x017f,0x0185,0x018b,
  0x0191,0x0198,0x019e,0x01a4,0x01aa,0x01b1,0x01b7,0x01bd,0x01c3,0x01ca,0x01d0,0x01d6,0x01dc,0x01e3,0x01e9,0x01ef,
  0x01f5,0x01fc,0x0202,0x0208,0x020e,0x0215,0x021b,0x0221,0x0227,0x022d,0x0234,0x023a,0x0240,0x0246,0x024d,0x0253,
  0x0259,0x025f,0x0265,0x026c,0x0272,0x0278,0x027e,0x0284,0x028b,0x0291,0x0297,0x029d,0x02a3,0x02aa,0x02b0,0x02b6,
  0x02bc,0x02c2,0x02c9,0x02cf,0x02d5,0x02db,0x02e1,0x02e8,0x02ee,0x02f4,0x02fa,0x0300,0x0306,0x030d,0x0313,0x0319,
  0x031f,0x0325,0x032b,0x0332,0x0338,0x033e,0x0344,0x034a,0x0350,0x0356,0x035d,0x0363,0x0369,0x036f,0x0375,0x037b,
  0x0381,0x0388,0x038e,0x0394,0x039a,0x03a0,0x03a6,0x03ac,0x03b2,0x03b9,0x03bf,0x03c5,0x03cb,0x03d1,0x03d7,0x03dd,
  0x03e3,0x03e9,0x03ef,0x03f6,0x03fc,0x0402,0x0408,0x040e,0x0414,0x041a,0x0420,0x0426,0x042c,0x0432,0x0438,0x043e,
  0x0444,0x044b,0x0451,0x0457,0x045d,0x0463,0x0469,0x046f,0x0475,0x047b,0x0481,0x0487,0x048d,0x0493,0x0499,0x049f,
  0x04a5,0x04ab,0x04b1,0x04b7,0x04bd,0x04c3,0x04c9,0x04cf,0x04d5,0x04db,0x04e1,0x04e7,0x04ed,0x04f3,0x04f9,0x04ff,
  0x0505,0x050b,0x0511,0x0517,0x051d,0x0523,0x0529,0x052f,0x0534,0x053a,0x0540,0x0546,0x054c,0x0552,0x0558,0x055e,
  0x0564,0x056a,0x0570,0x0576,0x057c,0x0581,0x0587,0x058d,0x0593,0x0599,0x059f,0x05a5,0x05ab,0x05b1,0x05b6,0x05bc,
  0x05c2,0x05c8,0x05ce,0x05d4,0x05da,0x05df,0x05e5,0x05eb,0x05f1,0x05f7,0x05fd,0x0602,0x0608,0x060e,0x0614,0x061a,
  0x061f,0x0625,0x062b,0x0631,0x0637,0x063c,0x0642,0x0648,0x064e,0x0654,0x0659,0x065f,0x0665,0x066b,0x0670,0x0676,
  0x067c,0x0682,0x0687,0x068d,0x0693,0x0699,0x069e,0x06a4,0x06aa,0x06af,0x06b5,0x06bb,0x06c1,0x06c6,0x06cc,0x06d2,
  0x06d7,0x06dd,0x06e3,0x06e8,0x06ee,0x06f4,0x06f9,0x06ff,0x0705,0x070a,0x0710,0x0715,0x071b,0x0721,0x0726,0x072c,
  0x0732,0x0737,0x073d,0x0742,0x0748,0x074e,0x0753,0x0759,0x075e,0x0764,0x076a,0x076f,0x0775,0x077a,0x0780,0x0785,
  0x078b,0x0790,0x0796,0x079b,0x07a1,0x07a6,0x07ac,0x07b2,0x07b7,0x07bd,0x07c2,0x07c8,0x07cd,0x07d2,0x07d8,0x07dd,
  0x07e3,0x07e8,0x07ee,0x07f3,0x07f9,0x07fe,0x0804,0x0809,0x080e,0x0814,0x0819,0x081f,0x0824,0x082a,0x082f,0x0834,
  0x083a,0x083f,0x0845,0x084a,0x084f,0x0855,0x085a,0x085f,0x0865,0x086a,0x086f,0x0875,0x087a,0x087f,0x0885,0x088a,
  0x088f,0x0895,0x089a,0x089f,0x08a5,0x08aa,0x08af,0x08b4,0x08ba,0x08bf,0x08c4,0x08c9,0x08cf,0x08d4,0x08d9,0x08de,
  0x08e4,0x08e9,0x08ee,0x08f3,0x08f8,0x08fe,0x0903,0x0908,0x090d,0x0912,0x0918,0x091d,0x0922,0x0927,0x092c,0x0931,
  0x0937,0x093c,0x0941,0x0946,0x094b,0x0950,0x0955,0x095a,0x095f,0x0965,0x096a,0x096f,0x0974,0x0979,0x097e,0x0983,
  0x0988,0x098d,0x0992,0x0997,0x099c,0x09a1,0x09a6,0x09ab,0x09b0,0x09b5,0x09ba,0x09bf,0x09c4,0x09c9,0x09ce,0x09d3,
  0x09d8,0x09dd,0x09e2,0x09e7,0x09ec,0x09f1,0x09f6,0x09fb,0x09ff,0x0a04,0x0a09,0x0a0e,0x0a13,0x0a18,0x0a1d,0x0a22,
  0x0a26,0x0a2b,0x0a30,0x0a35,0x0a3a,0x0a3f,0x0a44,0x0a48,0x0a4d,0x0a52,0x0a57,0x0a5c,0x0a60,0x0a65,0x0a6a,0x0a6f,
  0x0a73,0x0a78,0x0a7d,0x0a82,0x0a86,0x0a8b,0x0a90,0x0a95,0x0a99,0x0a9e,0x0aa3,0x0aa7,0x0aac,0x0ab1,0x0ab5,0x0aba,
  0x0abf,0x0ac3,0x0ac8,0x0acd,0x0ad1,0x0ad6,0x0adb,0x0adf,0x0ae4,0x0ae8,0x0aed,0x0af2,0x0af6,0x0afb,0x0aff,0x0b04,
  0x0b08,0x0b0d,0x0b11,0x0b16,0x0b1b,0x0b1f,0x0b24,0x0b28,0x0b2d,0x0b31,0x0b36,0x0b3a,0x0b3e,0x0b43,0x0b47,0x0b4c,
  0x0b50,0x0b55,0x0b59,0x0b5e,0x0b62,0x0b66,0x0b6b,0x0b6f,0x0b74,0x0b78,0x0b7c,0x0b81,0x0b85,0x0b89,0x0b8e,0x0b92,
  0x0b97,0x0b9b,0x0b9f,0x0ba3,0x0ba8,0x0bac,0x0bb0,0x0bb5,0x0bb9,0x0bbd,0x0bc1,0x0bc6,0x0bca,0x0bce,0x0bd2,0x0bd7,
  0x0bdb,0x0bdf,0x0be3,0x0be8,0x0bec,0x0bf0,0x0bf4,0x0bf8,0x0bfc,0x0c01,0x0c05,0x0c09,0x0c0d,0x0c11,0x0c15,0x0c19,
  0x0c1e,0x0c22,0x0c26,0x0c2a,0x0c2e,0x0c32,0x0c36,0x0c3a,0x0c3e,0x0c42,0x0c46,0x0c4a,0x0c4e,0x0c52,0x0c56,0x0c5a,
  0x0c5e,0x0c62,0x0c66,0x0c6a,0x0c6e,0x0c72,0x0c76,0x0c7a,0x0c7e,0x0c82,0x0c86,0x0c8a,0x0c8e,0x0c91,0x0c95,0x0c99,
  0x0c9d,0x0ca1,0x0ca5,0x0ca9,0x0cac,0x0cb0,0x0cb4,0x0cb8,0x0cbc,0x0cc0,0x0cc3,0x0cc7,0x0ccb,0x0ccf,0x0cd2,0x0cd6,
  0x0cda,0x0cde,0x0ce1,0x0ce5,0x0ce9,0x0ced,0x0cf0,0x0cf4,0x0cf8,0x0cfb,0x0cff,0x0d03,0x0d06,0x0d0a,0x0d0e,0x0d11,
  0x0d15,0x0d18,0x0d1c,0x0d20,0x0d23,0x0d27,0x0d2a,0x0d2e,0x0d32,0x0d35,0x0d39,0x0d3c,0x0d40,0x0d43,0x0d47,0x0d4a,
  0x0d4e,0x0d51,0x0d55,0x0d58,0x0d5c,0x0d5f,0x0d62,0x0d66,0x0d69,0x0d6d,0x0d70,0x0d74,0x0d77,0x0d7a,0x0d7e,0x0d81,
  0x0d85,0x0d88,0x0d8b,0x0d8f,0x0d92,0x0d95,0x0d99,0x0d9c,0x0d9f,0x0da2,0x0da6,0x0da9,0x0dac,0x0db0,0x0db3,0x0db6,
  0x0db9,0x0dbc,0x0dc0,0x0dc3,0x0dc6,0x0dc9,0x0dcc,0x0dd0,0x0dd3,0x0dd6,0x0dd9,0x0ddc,0x0ddf,0x0de3,0x0de6,0x0de9,
  0x0dec,0x0def,0x0df2,0x0df5,0x0df8,0x0dfb,0x0dfe,0x0e01,0x0e04,0x0e07,0x0e0a,0x0e0d,0x0e10,0x0e13,0x0e16,0x0e19,
  0x0e1c,0x0e1f,0x0e22,0x0e25,0x0e28,0x0e2b,0x0e2e,0x0e31,0x0e34,0x0e37,0x0e3a,0x0e3c,0x0e3f,0x0e42,0x0e45,0x0e48,
  0x0e4b,0x0e4d,0x0e50,0x0e53,0x0e56,0x0e59,0x0e5b,0x0e5e,0x0e61,0x0e64,0x0e66,0x0e69,0x0e6c,0x0e6f,0x0e71,0x0e74,
  0x0e77,0x0e79,0x0e7c,0x0e7f,0x0e81,0x0e84,0x0e87,0x0e89,0x0e8c,0x0e8f,0x0e91,0x0e94,0x0e96,0x0e99,0x0e9b,0x0e9e,
  0x0ea1,0x0ea3,0x0ea6,0x0ea8,0x0eab,0x0ead,0x0eb0,0x0eb2,0x0eb5,0x0eb7,0x0eba,0x0ebc,0x0ebf,0x0ec1,0x0ec3,0x0ec6,
  0x0ec8,0x0ecb,0x0ecd,0x0ecf,0x0ed2,0x0ed4,0x0ed6,0x0ed9,0x0edb,0x0edd,0x0ee0,0x0ee2,0x0ee4,0x0ee7,0x0ee9,0x0eeb,
  0x0eee,0x0ef0,0x0ef2,0x0ef4,0x0ef7,0x0ef9,0x0efb,0x0efd,0x0eff,0x0f02,0x0f04,0x0f06,0x0f08,0x0f0a,0x0f0c,0x0f0e,
  0x0f11,0x0f13,0x0f15,0x0f17,0x0f19,0x0f1b,0x0f1d,0x0f1f,0x0f21,0x0f23,0x0f25,0x0f27,0x0f29,0x0f2b,0x0f2d,0x0f2f,
  0x0f31,0x0f33,0x0f35,0x0f37,0x0f39,0x0f3b,0x0f3d,0x0f3f,0x0f41,0x0f43,0x0f45,0x0f46,0x0f48,0x0f4a,0x0f4c,0x0f4e,
  0x0f50,0x0f51,0x0f53,0x0f55,0x0f57,0x0f59,0x0f5a,0x0f5c,0x0f5e,0x0f60,0x0f61,0x0f63,0x0f65,0x0f67,0x0f68,0x0f6a,
  0x0f6c,0x0f6d,0x0f6f,0x0f71,0x0f72,0x0f74,0x0f76,0x0f77,0x0f79,0x0f7a,0x0f7c,0x0f7d,0x0f7f,0x0f81,0x0f82,0x0f84,
  0x0f85,0x0f87,0x0f88,0x0f8a,0x0f8b,0x0f8d,0x0f8e,0x0f90,0x0f91,0x0f93,0x0f94,0x0f95,0x0f97,0x0f98,0x0f9a,0x0f9b,
  0x0f9c,0x0f9e,0x0f9f,0x0fa1,0x0fa2,0x0fa3,0x0fa5,0x0fa6,0x0fa7,0x0fa8,0x0faa,0x0fab,0x0fac,0x0fae,0x0faf,0x0fb0,
  0x0fb1,0x0fb3,0x0fb4,0x0fb5,0x0fb6,0x0fb7,0x0fb8,0x0fba,0x0fbb,0x0fbc,0x0fbd,0x0fbe,0x0fbf,0x0fc0,0x0fc2,0x0fc3,
  0x0fc4,0x0fc5,0x0fc6,0x0fc7,0x0fc8,0x0fc9,0x0fca,0x0fcb,0x0fcc,0x0fcd,0x0fce,0x0fcf,0x0fd0,0x0fd1,0x0fd2,0x0fd3,
  0x0fd4,0x0fd5,0x0fd5,0x0fd6,0x0fd7,0x0fd8,0x0fd9,0x0fda,0x0fdb,0x0fdc,0x0fdc,0x0fdd,0x0fde,0x0fdf,0x0fe0,0x0fe0,
  0x0fe1,0x0fe2,0x0fe3,0x0fe3,0x0fe4,0x0fe5,0x0fe6,0x0fe6,0x0fe7,0x0fe8,0x0fe8,0x0fe9,0x0fea,0x0fea,0x0feb,0x0fec,
  0x0fec,0x0fed,0x0fed,0x0fee,0x0fef,0x0fef,0x0ff0,0x0ff0,0x0ff1,0x0ff1,0x0ff2,0x0ff2,0x0ff3,0x0ff3,0x0ff4,0x0ff4,
  0x0ff5,0x0ff5,0x0ff6,0x0ff6,0x0ff7,0x0ff7,0x0ff8,0x0ff8,0x0ff8,0x0ff9,0x0ff9,0x0ff9,0x0ffa,0x0ffa,0x0ffa,0x0ffb,
  0x0ffb,0x0ffb,0x0ffc,0x0ffc,0x0ffc,0x0ffc,0x0ffd,0x0ffd,0x0ffd,0x0ffd,0x0ffe,0x0ffe,0x0ffe,0x0ffe,0x0ffe,0x0fff,
  0x0fff,0x0fff,0x0fff,0x0fff,0x0fff,0x0fff,0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,
  0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,0x1000,0x0fff,0x0fff,0x0fff,0x0fff,0x0fff,
  0x0fff,0x0fff,0x0ffe,0x0ffe,0x0ffe,0x0ffe,0x0ffe,0x0ffd,0x0ffd,0x0ffd,0x0ffd,0x0ffc,0x0ffc,0x0ffc,0x0ffc,0x0ffb,
  0x0ffb,0x0ffb,0x0ffa,0x0ffa,0x0ffa,0x0ff9,0x0ff9,0x0ff9,0x0ff8,0x0ff8,0x0ff8,0x0ff7,0x0ff7,0x0ff6,0x0ff6,0x0ff5,
  0x0ff5,0x0ff4,0x0ff4,0x0ff3,0x0ff3,0x0ff2,0x0ff2,0x0ff1,0x0ff1,0x0ff0,0x0ff0,0x0fef,0x0fef,0x0fee,0x0fed,0x0fed,
  0x0fec,0x0fec,0x0feb,0x0fea,0x0fea,0x0fe9,0x0fe8,0x0fe8,0x0fe7,0x0fe6,0x0fe6,0x0fe5,0x0fe4,0x0fe3,0x0fe3,0x0fe2,
  0x0fe1,0x0fe0,0x0fe0,0x0fdf,0x0fde,0x0fdd,0x0fdc,0x0fdc,0x0fdb,0x0fda,0x0fd9,0x0fd8,0x0fd7,0x0fd6,0x0fd5,0x0fd5,
  0x0fd4,0x0fd3,0x0fd2,0x0fd1,0x0fd0,0x0fcf,0x0fce,0x0fcd,0x0fcc,0x0fcb,0x0fca,0x0fc9,0x0fc8,0x0fc7,0x0fc6,0x0fc5,
  0x0fc4,0x0fc3,0x0fc2,0x0fc0,0x0fbf,0x0fbe,0x0fbd,0x0fbc,0x0fbb,0x0fba,0x0fb8,0x0fb7,0x0fb6,0x0fb5,0x0fb4,0x0fb3,
  0x0fb1,0x0fb0,0x0faf,0x0fae,0x0fac,0x0fab,0x0faa,0x0fa8,0x0fa7,0x0fa6,0x0fa5,0x0fa3,0x0fa2,0x0fa1,0x0f9f,0x0f9e,
  0x0f9c,0x0f9b,0x0f9a,0x0f98,0x0f97,0x0f95,0x0f94,0x0f93,0x0f91,0x0f90,0x0f8e,0x0f8d,0x0f8b,0x0f8a,0x0f88,0x0f87,
  0x0f85,0x0f84,0x0f82,0x0f81,0x0f7f,0x0f7d,0x0f7c,0x0f7a,0x0f79,0x0f77,0x0f76,0x0f74,0x0f72,0x0f71,0x0f6f,0x0f6d,
  0x0f6c,0x0f6a,0x0f68,0x0f67,0x0f65,0x0f63,0x0f61,0x0f60,0x0f5e,0x0f5c,0x0f5a,0x0f59,0x0f57,0x0f55,0x0f53,0x0f51,
  0x0f50,0x0f4e,0x0f4c,0x0f4a,0x0f48,0x0f46,0x0f45,0x0f43,0x0f41,0x0f3f,0x0f3d,0x0f3b,0x0f39,0x0f37,0x0f35,0x0f33,
  0x0f31,0x0f2f,0x0f2d,0x0f2b,0x0f29,0x0f27,0x0f25,0x0f23,0x0f21,0x0f1f,0x0f1d,0x0f1b,0x0f19,0x0f17,0x0f15,0x0f13,
  0x0f11,0x0f0e,0x0f0c,0x0f0a,0x0f08,0x0f06,0x0f04,0x0f02,0x0eff,0x0efd,0x0efb,0x0ef9,0x0ef7,0x0ef4,0x0ef2,0x0ef0,
  0x0eee,0x0eeb,0x0ee9,0x0ee7,0x0ee4,0x0ee2,0x0ee0,0x0edd,0x0edb,0x0ed9,0x0ed6,0x0ed4,0x0ed2,0x0ecf,0x0ecd,0x0ecb,
  0x0ec8,0x0ec6,0x0ec3,0x0ec1,0x0ebf,0x0ebc,0x0eba,0x0eb7,0x0eb5,0x0eb2,0x0eb0,0x0ead,0x0eab,0x0ea8,0x0ea6,0x0ea3,
  0x0ea1,0x0e9e,0x0e9b,0x0e99,0x0e96,0x0e94,0x0e91,0x0e8f,0x0e8c,0x0e89,0x0e87,0x0e84,0x0e81,0x0e7f,0x0e7c,0x0e79,
  0x0e77,0x0e74,0x0e71,0x0e6f,0x0e6c,0x0e69,0x0e66,0x0e64,0x0e61,0x0e5e,0x0e5b,0x0e59,0x0e56,0x0e53,0x0e50,0x0e4d,
  0x0e4b,0x0e48,0x0e45,0x0e42,0x0e3f,0x0e3c,0x0e3a,0x0e37,0x0e34,0x0e31,0x0e2e,0x0e2b,0x0e28,0x0e25,0x0e22,0x0e1f,
  0x0e1c,0x0e19,0x0e16,0x0e13,0x0e10,0x0e0d,0x0e0a,0x0e07,0x0e04,0x0e01,0x0dfe,0x0dfb,0x0df8,0x0df5,0x0df2,0x0def,
  0x0dec,0x0de9,0x0de6,0x0de3,0x0ddf,0x0ddc,0x0dd9,0x0dd6,0x0dd3,0x0dd0,0x0dcc,0x0dc9,0x0dc6,0x0dc3,0x0dc0,0x0dbc,
  0x0db9,0x0db6,0x0db3,0x0db0,0x0dac,0x0da9,0x0da6,0x0da2,0x0d9f,0x0d9c,0x0d99,0x0d95,0x0d92,0x0d8f,0x0d8b,0x0d88,
  0x0d85,0x0d81,0x0d7e,0x0d7a,0x0d77,0x0d74,0x0d70,0x0d6d,0x0d69,0x0d66,0x0d62,0x0d5f,0x0d5c,0x0d58,0x0d55,0x0d51,
  0x0d4e,0x0d4a,0x0d47,0x0d43,0x0d40,0x0d3c,0x0d39,0x0d35,0x0d32,0x0d2e,0x0d2a,0x0d27,0x0d23,0x0d20,0x0d1c,0x0d18,
  0x0d15,0x0d11,0x0d0e,0x0d0a,0x0d06,0x0d03,0x0cff,0x0cfb,0x0cf8,0x0cf4,0x0cf0,0x0ced,0x0ce9,0x0ce5,0x0ce1,0x0cde,
  0x0cda,0x0cd6,0x0cd2,0x0ccf,0x0ccb,0x0cc7,0x0cc3,0x0cc0,0x0cbc,0x0cb8,0x0cb4,0x0cb0,0x0cac,0x0ca9,0x0ca5,0x0ca1,
  0x0c9d,0x0c99,0x0c95,0x0c91,0x0c8e,0x0c8a,0x0c86,0x0c82,0x0c7e,0x0c7a,0x0c76,0x0c72,0x0c6e,0x0c6a,0x0c66,0x0c62,
  0x0c5e,0x0c5a,0x0c56,0x0c52,0x0c4e,0x0c4a,0x0c46,0x0c42,0x0c3e,0x0c3a,0x0c36,0x0c32,0x0c2e,0x0c2a,0x0c26,0x0c22,
  0x0c1e,0x0c19,0x0c15,0x0c11,0x0c0d,0x0c09,0x0c05,0x0c01,0x0bfc,0x0bf8,0x0bf4,0x0bf0,0x0bec,0x0be8,0x0be3,0x0bdf,
  0x0bdb,0x0bd7,0x0bd2,0x0bce,0x0bca,0x0bc6,0x0bc1,0x0bbd,0x0bb9,0x0bb5,0x0bb0,0x0bac,0x0ba8,0x0ba3,0x0b9f,0x0b9b,
  0x0b97,0x0b92,0x0b8e,0x0b89,0x0b85,0x0b81,0x0b7c,0x0b78,0x0b74,0x0b6f,0x0b6b,0x0b66,0x0b62,0x0b5e,0x0b59,0x0b55,
  0x0b50,0x0b4c,0x0b47,0x0b43,0x0b3e,0x0b3a,0x0b36,0x0b31,0x0b2d,0x0b28,0x0b24,0x0b1f,0x0b1b,0x0b16,0x0b11,0x0b0d,
  0x0b08,0x0b04,0x0aff,0x0afb,0x0af6,0x0af2,0x0aed,0x0ae8,0x0ae4,0x0adf,0x0adb,0x0ad6,0x0ad1,0x0acd,0x0ac8,0x0ac3,
  0x0abf,0x0aba,0x0ab5,0x0ab1,0x0aac,0x0aa7,0x0aa3,0x0a9e,0x0a99,0x0a95,0x0a90,0x0a8b,0x0a86,0x0a82,0x0a7d,0x0a78,
  0x0a73,0x0a6f,0x0a6a,0x0a65,0x0a60,0x0a5c,0x0a57,0x0a52,0x0a4d,0x0a48,0x0a44,0x0a3f,0x0a3a,0x0a35,0x0a30,0x0a2b,
  0x0a26,0x0a22,0x0a1d,0x0a18,0x0a13,0x0a0e,0x0a09,0x0a04,0x09ff,0x09fb,0x09f6,0x09f1,0x09ec,0x09e7,0x09e2,0x09dd,
  0x09d8,0x09d3,0x09ce,0x09c9,0x09c4,0x09bf,0x09ba,0x09b5,0x09b0,0x09ab,0x09a6,0x09a1,0x099c,0x0997,0x0992,0x098d,
  0x0988,0x0983,0x097e,0x0979,0x0974,0x096f,0x096a,0x0965,0x095f,0x095a,0x0955,0x0950,0x094b,0x0946,0x0941,0x093c,
  0x0937,0x0931,0x092c,0x0927,0x0922,0x091d,0x0918,0x0912,0x090d,0x0908,0x0903,0x08fe,0x08f8,0x08f3,0x08ee,0x08e9,
  0x08e4,0x08de,0x08d9,0x08d4,0x08cf,0x08c9,0x08c4,0x08bf,0x08ba,0x08b4,0x08af,0x08aa,0x08a5,0x089f,0x089a,0x0895,
  0x088f,0x088a,0x0885,0x087f,0x087a,0x0875,0x086f,0x086a,0x0865,0x085f,0x085a,0x0855,0x084f,0x084a,0x0845,0x083f,
  0x083a,0x0834,0x082f,0x082a,0x0824,0x081f,0x0819,0x0814,0x080e,0x0809,0x0804,0x07fe,0x07f9,0x07f3,0x07ee,0x07e8,
  0x07e3,0x07dd,0x07d8,0x07d2,0x07cd,0x07c8,0x07c2,0x07bd,0x07b7,0x07b2,0x07ac,0x07a6,0x07a1,0x079b,0x0796,0x0790,
  0x078b,0x0785,0x0780,0x077a,0x0775,0x076f,0x076a,0x0764,0x075e,0x0759,0x0753,0x074e,0x0748,0x0742,0x073d,0x0737,
  0x0732,0x072c,0x0726,0x0721,0x071b,0x0715,0x0710,0x070a,0x0705,0x06ff,0x06f9,0x06f4,0x06ee,0x06e8,0x06e3,0x06dd,
  0x06d7,0x06d2,0x06cc,0x06c6,0x06c1,0x06bb,0x06b5,0x06af,0x06aa,0x06a4,0x069e,0x0699,0x0693,0x068d,0x0687,0x0682,
  0x067c,0x0676,0x0670,0x066b,0x0665,0x065f,0x0659,0x0654,0x064e,0x0648,0x0642,0x063c,0x0637,0x0631,0x062b,0x0625,
  0x061f,0x061a,0x0614,0x060e,0x0608,0x0602,0x05fd,0x05f7,0x05f1,0x05eb,0x05e5,0x05df,0x05da,0x05d4,0x05ce,0x05c8,
  0x05c2,0x05bc,0x05b6,0x05b1,0x05ab,0x05a5,0x059f,0x0599,0x0593,0x058d,0x0587,0x0581,0x057c,0x0576,0x0570,0x056a,
  0x0564,0x055e,0x0558,0x0552,0x054c,0x0546,0x0540,0x053a,0x0534,0x052f,0x0529,0x0523,0x051d,0x0517,0x0511,0x050b,
  0x0505,0x04ff,0x04f9,0x04f3,0x04ed,0x04e7,0x04e1,0x04db,0x04d5,0x04cf,0x04c9,0x04c3,0x04bd,0x04b7,0x04b1,0x04ab,
  0x04a5,0x049f,0x0499,0x0493,0x048d,0x0487,0x0481,0x047b,0x0475,0x046f,0x0469,0x0463,0x045d,0x0457,0x0451,0x044b,
  0x0444,0x043e,0x0438,0x0432,0x042c,0x0426,0x0420,0x041a,0x0414,0x040e,0x0408,0x0402,0x03fc,0x03f6,0x03ef,0x03e9,
  0x03e3,0x03dd,0x03d7,0x03d1,0x03cb,0x03c5,0x03bf,0x03b9,0x03b2,0x03ac,0x03a6,0x03a0,0x039a,0x0394,0x038e,0x0388,
  0x0381,0x037b,0x0375,0x036f,0x0369,0x0363,0x035d,0x0356,0x0350,0x034a,0x0344,0x033e,0x0338,0x0332,0x032b,0x0325,
  0x031f,0x0319,0x0313,0x030d,0x0306,0x0300,0x02fa,0x02f4,0x02ee,0x02e8,0x02e1,0x02db,0x02d5,0x02cf,0x02c9,0x02c2,
  0x02bc,0x02b6,0x02b0,0x02aa,0x02a3,0x029d,0x0297,0x0291,0x028b,0x0284,0x027e,0x0278,0x0272,0x026c,0x0265,0x025f,
  0x0259,0x0253,0x024d,0x0246,0x0240,0x023a,0x0234,0x022d,0x0227,0x0221,0x021b,0x0215,0x020e,0x0208,0x0202,0x01fc,
  0x01f5,0x01ef,0x01e9,0x01e3,0x01dc,0x01d6,0x01d0,0x01ca,0x01c3,0x01bd,0x01b7,0x01b1,0x01aa,0x01a4,0x019e,0x0198,
  0x0191,0x018b,0x0185,0x017f,0x0178,0x0172,0x016c,0x0166,0x015f,0x0159,0x0153,0x014d,0x0146,0x0140,0x013a,0x0134,
  0x012d,0x0127,0x0121,0x011b,0x0114,0x010e,0x0108,0x0101,0x00fb,0x00f5,0x00ef,0x00e8,0x00e2,0x00dc,0x00d6,0x00cf,
  0x00c9,0x00c3,0x00bc,0x00b6,0x00b0,0x00aa,0x00a3,0x009d,0x0097,0x0090,0x008a,0x0084,0x007e,0x0077,0x0071,0x006b,
  0x0065,0x005e,0x0058,0x0052,0x004b,0x0045,0x003f,0x0039,0x0032,0x002c,0x0026,0x001f,0x0019,0x0013,0x000d,0x0006,
  0x0000,(short)0xfffa,(short)0xfff3,(short)0xffed,(short)0xffe7,(short)0xffe1,(short)0xffda,(short)0xffd4,(short)0xffce,(short)0xffc7,(short)0xffc1,(short)0xffbb,(short)0xffb5,(short)0xffae,(short)0xffa8,(short)0xffa2,
  (short)0xff9b,(short)0xff95,(short)0xff8f,(short)0xff89,(short)0xff82,(short)0xff7c,(short)0xff76,(short)0xff70,(short)0xff69,(short)0xff63,(short)0xff5d,(short)0xff56,(short)0xff50,(short)0xff4a,(short)0xff44,(short)0xff3d,
  (short)0xff37,(short)0xff31,(short)0xff2a,(short)0xff24,(short)0xff1e,(short)0xff18,(short)0xff11,(short)0xff0b,(short)0xff05,(short)0xfeff,(short)0xfef8,(short)0xfef2,(short)0xfeec,(short)0xfee5,(short)0xfedf,(short)0xfed9,
  (short)0xfed3,(short)0xfecc,(short)0xfec6,(short)0xfec0,(short)0xfeba,(short)0xfeb3,(short)0xfead,(short)0xfea7,(short)0xfea1,(short)0xfe9a,(short)0xfe94,(short)0xfe8e,(short)0xfe88,(short)0xfe81,(short)0xfe7b,(short)0xfe75,
  (short)0xfe6f,(short)0xfe68,(short)0xfe62,(short)0xfe5c,(short)0xfe56,(short)0xfe4f,(short)0xfe49,(short)0xfe43,(short)0xfe3d,(short)0xfe36,(short)0xfe30,(short)0xfe2a,(short)0xfe24,(short)0xfe1d,(short)0xfe17,(short)0xfe11,
  (short)0xfe0b,(short)0xfe04,(short)0xfdfe,(short)0xfdf8,(short)0xfdf2,(short)0xfdeb,(short)0xfde5,(short)0xfddf,(short)0xfdd9,(short)0xfdd3,(short)0xfdcc,(short)0xfdc6,(short)0xfdc0,(short)0xfdba,(short)0xfdb3,(short)0xfdad,
  (short)0xfda7,(short)0xfda1,(short)0xfd9b,(short)0xfd94,(short)0xfd8e,(short)0xfd88,(short)0xfd82,(short)0xfd7c,(short)0xfd75,(short)0xfd6f,(short)0xfd69,(short)0xfd63,(short)0xfd5d,(short)0xfd56,(short)0xfd50,(short)0xfd4a,
  (short)0xfd44,(short)0xfd3e,(short)0xfd37,(short)0xfd31,(short)0xfd2b,(short)0xfd25,(short)0xfd1f,(short)0xfd18,(short)0xfd12,(short)0xfd0c,(short)0xfd06,(short)0xfd00,(short)0xfcfa,(short)0xfcf3,(short)0xfced,(short)0xfce7,
  (short)0xfce1,(short)0xfcdb,(short)0xfcd5,(short)0xfcce,(short)0xfcc8,(short)0xfcc2,(short)0xfcbc,(short)0xfcb6,(short)0xfcb0,(short)0xfcaa,(short)0xfca3,(short)0xfc9d,(short)0xfc97,(short)0xfc91,(short)0xfc8b,(short)0xfc85,
  (short)0xfc7f,(short)0xfc78,(short)0xfc72,(short)0xfc6c,(short)0xfc66,(short)0xfc60,(short)0xfc5a,(short)0xfc54,(short)0xfc4e,(short)0xfc47,(short)0xfc41,(short)0xfc3b,(short)0xfc35,(short)0xfc2f,(short)0xfc29,(short)0xfc23,
  (short)0xfc1d,(short)0xfc17,(short)0xfc11,(short)0xfc0a,(short)0xfc04,(short)0xfbfe,(short)0xfbf8,(short)0xfbf2,(short)0xfbec,(short)0xfbe6,(short)0xfbe0,(short)0xfbda,(short)0xfbd4,(short)0xfbce,(short)0xfbc8,(short)0xfbc2,
  (short)0xfbbc,(short)0xfbb5,(short)0xfbaf,(short)0xfba9,(short)0xfba3,(short)0xfb9d,(short)0xfb97,(short)0xfb91,(short)0xfb8b,(short)0xfb85,(short)0xfb7f,(short)0xfb79,(short)0xfb73,(short)0xfb6d,(short)0xfb67,(short)0xfb61,
  (short)0xfb5b,(short)0xfb55,(short)0xfb4f,(short)0xfb49,(short)0xfb43,(short)0xfb3d,(short)0xfb37,(short)0xfb31,(short)0xfb2b,(short)0xfb25,(short)0xfb1f,(short)0xfb19,(short)0xfb13,(short)0xfb0d,(short)0xfb07,(short)0xfb01,
  (short)0xfafb,(short)0xfaf5,(short)0xfaef,(short)0xfae9,(short)0xfae3,(short)0xfadd,(short)0xfad7,(short)0xfad1,(short)0xfacc,(short)0xfac6,(short)0xfac0,(short)0xfaba,(short)0xfab4,(short)0xfaae,(short)0xfaa8,(short)0xfaa2,
  (short)0xfa9c,(short)0xfa96,(short)0xfa90,(short)0xfa8a,(short)0xfa84,(short)0xfa7f,(short)0xfa79,(short)0xfa73,(short)0xfa6d,(short)0xfa67,(short)0xfa61,(short)0xfa5b,(short)0xfa55,(short)0xfa4f,(short)0xfa4a,(short)0xfa44,
  (short)0xfa3e,(short)0xfa38,(short)0xfa32,(short)0xfa2c,(short)0xfa26,(short)0xfa21,(short)0xfa1b,(short)0xfa15,(short)0xfa0f,(short)0xfa09,(short)0xfa03,(short)0xf9fe,(short)0xf9f8,(short)0xf9f2,(short)0xf9ec,(short)0xf9e6,
  (short)0xf9e1,(short)0xf9db,(short)0xf9d5,(short)0xf9cf,(short)0xf9c9,(short)0xf9c4,(short)0xf9be,(short)0xf9b8,(short)0xf9b2,(short)0xf9ac,(short)0xf9a7,(short)0xf9a1,(short)0xf99b,(short)0xf995,(short)0xf990,(short)0xf98a,
  (short)0xf984,(short)0xf97e,(short)0xf979,(short)0xf973,(short)0xf96d,(short)0xf967,(short)0xf962,(short)0xf95c,(short)0xf956,(short)0xf951,(short)0xf94b,(short)0xf945,(short)0xf93f,(short)0xf93a,(short)0xf934,(short)0xf92e,
  (short)0xf929,(short)0xf923,(short)0xf91d,(short)0xf918,(short)0xf912,(short)0xf90c,(short)0xf907,(short)0xf901,(short)0xf8fb,(short)0xf8f6,(short)0xf8f0,(short)0xf8eb,(short)0xf8e5,(short)0xf8df,(short)0xf8da,(short)0xf8d4,
  (short)0xf8ce,(short)0xf8c9,(short)0xf8c3,(short)0xf8be,(short)0xf8b8,(short)0xf8b2,(short)0xf8ad,(short)0xf8a7,(short)0xf8a2,(short)0xf89c,(short)0xf896,(short)0xf891,(short)0xf88b,(short)0xf886,(short)0xf880,(short)0xf87b,
  (short)0xf875,(short)0xf870,(short)0xf86a,(short)0xf865,(short)0xf85f,(short)0xf85a,(short)0xf854,(short)0xf84e,(short)0xf849,(short)0xf843,(short)0xf83e,(short)0xf838,(short)0xf833,(short)0xf82e,(short)0xf828,(short)0xf823,
  (short)0xf81d,(short)0xf818,(short)0xf812,(short)0xf80d,(short)0xf807,(short)0xf802,(short)0xf7fc,(short)0xf7f7,(short)0xf7f2,(short)0xf7ec,(short)0xf7e7,(short)0xf7e1,(short)0xf7dc,(short)0xf7d6,(short)0xf7d1,(short)0xf7cc,
  (short)0xf7c6,(short)0xf7c1,(short)0xf7bb,(short)0xf7b6,(short)0xf7b1,(short)0xf7ab,(short)0xf7a6,(short)0xf7a1,(short)0xf79b,(short)0xf796,(short)0xf791,(short)0xf78b,(short)0xf786,(short)0xf781,(short)0xf77b,(short)0xf776,
  (short)0xf771,(short)0xf76b,(short)0xf766,(short)0xf761,(short)0xf75b,(short)0xf756,(short)0xf751,(short)0xf74c,(short)0xf746,(short)0xf741,(short)0xf73c,(short)0xf737,(short)0xf731,(short)0xf72c,(short)0xf727,(short)0xf722,
  (short)0xf71c,(short)0xf717,(short)0xf712,(short)0xf70d,(short)0xf708,(short)0xf702,(short)0xf6fd,(short)0xf6f8,(short)0xf6f3,(short)0xf6ee,(short)0xf6e8,(short)0xf6e3,(short)0xf6de,(short)0xf6d9,(short)0xf6d4,(short)0xf6cf,
  (short)0xf6c9,(short)0xf6c4,(short)0xf6bf,(short)0xf6ba,(short)0xf6b5,(short)0xf6b0,(short)0xf6ab,(short)0xf6a6,(short)0xf6a1,(short)0xf69b,(short)0xf696,(short)0xf691,(short)0xf68c,(short)0xf687,(short)0xf682,(short)0xf67d,
  (short)0xf678,(short)0xf673,(short)0xf66e,(short)0xf669,(short)0xf664,(short)0xf65f,(short)0xf65a,(short)0xf655,(short)0xf650,(short)0xf64b,(short)0xf646,(short)0xf641,(short)0xf63c,(short)0xf637,(short)0xf632,(short)0xf62d,
  (short)0xf628,(short)0xf623,(short)0xf61e,(short)0xf619,(short)0xf614,(short)0xf60f,(short)0xf60a,(short)0xf605,(short)0xf601,(short)0xf5fc,(short)0xf5f7,(short)0xf5f2,(short)0xf5ed,(short)0xf5e8,(short)0xf5e3,(short)0xf5de,
  (short)0xf5da,(short)0xf5d5,(short)0xf5d0,(short)0xf5cb,(short)0xf5c6,(short)0xf5c1,(short)0xf5bc,(short)0xf5b8,(short)0xf5b3,(short)0xf5ae,(short)0xf5a9,(short)0xf5a4,(short)0xf5a0,(short)0xf59b,(short)0xf596,(short)0xf591,
  (short)0xf58d,(short)0xf588,(short)0xf583,(short)0xf57e,(short)0xf57a,(short)0xf575,(short)0xf570,(short)0xf56b,(short)0xf567,(short)0xf562,(short)0xf55d,(short)0xf559,(short)0xf554,(short)0xf54f,(short)0xf54b,(short)0xf546,
  (short)0xf541,(short)0xf53d,(short)0xf538,(short)0xf533,(short)0xf52f,(short)0xf52a,(short)0xf525,(short)0xf521,(short)0xf51c,(short)0xf518,(short)0xf513,(short)0xf50e,(short)0xf50a,(short)0xf505,(short)0xf501,(short)0xf4fc,
  (short)0xf4f8,(short)0xf4f3,(short)0xf4ef,(short)0xf4ea,(short)0xf4e5,(short)0xf4e1,(short)0xf4dc,(short)0xf4d8,(short)0xf4d3,(short)0xf4cf,(short)0xf4ca,(short)0xf4c6,(short)0xf4c2,(short)0xf4bd,(short)0xf4b9,(short)0xf4b4,
  (short)0xf4b0,(short)0xf4ab,(short)0xf4a7,(short)0xf4a2,(short)0xf49e,(short)0xf49a,(short)0xf495,(short)0xf491,(short)0xf48c,(short)0xf488,(short)0xf484,(short)0xf47f,(short)0xf47b,(short)0xf477,(short)0xf472,(short)0xf46e,
  (short)0xf469,(short)0xf465,(short)0xf461,(short)0xf45d,(short)0xf458,(short)0xf454,(short)0xf450,(short)0xf44b,(short)0xf447,(short)0xf443,(short)0xf43f,(short)0xf43a,(short)0xf436,(short)0xf432,(short)0xf42e,(short)0xf429,
  (short)0xf425,(short)0xf421,(short)0xf41d,(short)0xf418,(short)0xf414,(short)0xf410,(short)0xf40c,(short)0xf408,(short)0xf404,(short)0xf3ff,(short)0xf3fb,(short)0xf3f7,(short)0xf3f3,(short)0xf3ef,(short)0xf3eb,(short)0xf3e7,
  (short)0xf3e2,(short)0xf3de,(short)0xf3da,(short)0xf3d6,(short)0xf3d2,(short)0xf3ce,(short)0xf3ca,(short)0xf3c6,(short)0xf3c2,(short)0xf3be,(short)0xf3ba,(short)0xf3b6,(short)0xf3b2,(short)0xf3ae,(short)0xf3aa,(short)0xf3a6,
  (short)0xf3a2,(short)0xf39e,(short)0xf39a,(short)0xf396,(short)0xf392,(short)0xf38e,(short)0xf38a,(short)0xf386,(short)0xf382,(short)0xf37e,(short)0xf37a,(short)0xf376,(short)0xf372,(short)0xf36f,(short)0xf36b,(short)0xf367,
  (short)0xf363,(short)0xf35f,(short)0xf35b,(short)0xf357,(short)0xf354,(short)0xf350,(short)0xf34c,(short)0xf348,(short)0xf344,(short)0xf340,(short)0xf33d,(short)0xf339,(short)0xf335,(short)0xf331,(short)0xf32e,(short)0xf32a,
  (short)0xf326,(short)0xf322,(short)0xf31f,(short)0xf31b,(short)0xf317,(short)0xf313,(short)0xf310,(short)0xf30c,(short)0xf308,(short)0xf305,(short)0xf301,(short)0xf2fd,(short)0xf2fa,(short)0xf2f6,(short)0xf2f2,(short)0xf2ef,
  (short)0xf2eb,(short)0xf2e8,(short)0xf2e4,(short)0xf2e0,(short)0xf2dd,(short)0xf2d9,(short)0xf2d6,(short)0xf2d2,(short)0xf2ce,(short)0xf2cb,(short)0xf2c7,(short)0xf2c4,(short)0xf2c0,(short)0xf2bd,(short)0xf2b9,(short)0xf2b6,
  (short)0xf2b2,(short)0xf2af,(short)0xf2ab,(short)0xf2a8,(short)0xf2a4,(short)0xf2a1,(short)0xf29e,(short)0xf29a,(short)0xf297,(short)0xf293,(short)0xf290,(short)0xf28c,(short)0xf289,(short)0xf286,(short)0xf282,(short)0xf27f,
  (short)0xf27b,(short)0xf278,(short)0xf275,(short)0xf271,(short)0xf26e,(short)0xf26b,(short)0xf267,(short)0xf264,(short)0xf261,(short)0xf25e,(short)0xf25a,(short)0xf257,(short)0xf254,(short)0xf250,(short)0xf24d,(short)0xf24a,
  (short)0xf247,(short)0xf244,(short)0xf240,(short)0xf23d,(short)0xf23a,(short)0xf237,(short)0xf234,(short)0xf230,(short)0xf22d,(short)0xf22a,(short)0xf227,(short)0xf224,(short)0xf221,(short)0xf21d,(short)0xf21a,(short)0xf217,
  (short)0xf214,(short)0xf211,(short)0xf20e,(short)0xf20b,(short)0xf208,(short)0xf205,(short)0xf202,(short)0xf1ff,(short)0xf1fc,(short)0xf1f9,(short)0xf1f6,(short)0xf1f3,(short)0xf1f0,(short)0xf1ed,(short)0xf1ea,(short)0xf1e7,
  (short)0xf1e4,(short)0xf1e1,(short)0xf1de,(short)0xf1db,(short)0xf1d8,(short)0xf1d5,(short)0xf1d2,(short)0xf1cf,(short)0xf1cc,(short)0xf1c9,(short)0xf1c6,(short)0xf1c4,(short)0xf1c1,(short)0xf1be,(short)0xf1bb,(short)0xf1b8,
  (short)0xf1b5,(short)0xf1b3,(short)0xf1b0,(short)0xf1ad,(short)0xf1aa,(short)0xf1a7,(short)0xf1a5,(short)0xf1a2,(short)0xf19f,(short)0xf19c,(short)0xf19a,(short)0xf197,(short)0xf194,(short)0xf191,(short)0xf18f,(short)0xf18c,
  (short)0xf189,(short)0xf187,(short)0xf184,(short)0xf181,(short)0xf17f,(short)0xf17c,(short)0xf179,(short)0xf177,(short)0xf174,(short)0xf171,(short)0xf16f,(short)0xf16c,(short)0xf16a,(short)0xf167,(short)0xf165,(short)0xf162,
  (short)0xf15f,(short)0xf15d,(short)0xf15a,(short)0xf158,(short)0xf155,(short)0xf153,(short)0xf150,(short)0xf14e,(short)0xf14b,(short)0xf149,(short)0xf146,(short)0xf144,(short)0xf141,(short)0xf13f,(short)0xf13d,(short)0xf13a,
  (short)0xf138,(short)0xf135,(short)0xf133,(short)0xf131,(short)0xf12e,(short)0xf12c,(short)0xf12a,(short)0xf127,(short)0xf125,(short)0xf123,(short)0xf120,(short)0xf11e,(short)0xf11c,(short)0xf119,(short)0xf117,(short)0xf115,
  (short)0xf112,(short)0xf110,(short)0xf10e,(short)0xf10c,(short)0xf109,(short)0xf107,(short)0xf105,(short)0xf103,(short)0xf101,(short)0xf0fe,(short)0xf0fc,(short)0xf0fa,(short)0xf0f8,(short)0xf0f6,(short)0xf0f4,(short)0xf0f2,
  (short)0xf0ef,(short)0xf0ed,(short)0xf0eb,(short)0xf0e9,(short)0xf0e7,(short)0xf0e5,(short)0xf0e3,(short)0xf0e1,(short)0xf0df,(short)0xf0dd,(short)0xf0db,(short)0xf0d9,(short)0xf0d7,(short)0xf0d5,(short)0xf0d3,(short)0xf0d1,
  (short)0xf0cf,(short)0xf0cd,(short)0xf0cb,(short)0xf0c9,(short)0xf0c7,(short)0xf0c5,(short)0xf0c3,(short)0xf0c1,(short)0xf0bf,(short)0xf0bd,(short)0xf0bb,(short)0xf0ba,(short)0xf0b8,(short)0xf0b6,(short)0xf0b4,(short)0xf0b2,
  (short)0xf0b0,(short)0xf0af,(short)0xf0ad,(short)0xf0ab,(short)0xf0a9,(short)0xf0a7,(short)0xf0a6,(short)0xf0a4,(short)0xf0a2,(short)0xf0a0,(short)0xf09f,(short)0xf09d,(short)0xf09b,(short)0xf099,(short)0xf098,(short)0xf096,
  (short)0xf094,(short)0xf093,(short)0xf091,(short)0xf08f,(short)0xf08e,(short)0xf08c,(short)0xf08a,(short)0xf089,(short)0xf087,(short)0xf086,(short)0xf084,(short)0xf083,(short)0xf081,(short)0xf07f,(short)0xf07e,(short)0xf07c,
  (short)0xf07b,(short)0xf079,(short)0xf078,(short)0xf076,(short)0xf075,(short)0xf073,(short)0xf072,(short)0xf070,(short)0xf06f,(short)0xf06d,(short)0xf06c,(short)0xf06b,(short)0xf069,(short)0xf068,(short)0xf066,(short)0xf065,
  (short)0xf064,(short)0xf062,(short)0xf061,(short)0xf05f,(short)0xf05e,(short)0xf05d,(short)0xf05b,(short)0xf05a,(short)0xf059,(short)0xf058,(short)0xf056,(short)0xf055,(short)0xf054,(short)0xf052,(short)0xf051,(short)0xf050,
  (short)0xf04f,(short)0xf04d,(short)0xf04c,(short)0xf04b,(short)0xf04a,(short)0xf049,(short)0xf048,(short)0xf046,(short)0xf045,(short)0xf044,(short)0xf043,(short)0xf042,(short)0xf041,(short)0xf040,(short)0xf03e,(short)0xf03d,
  (short)0xf03c,(short)0xf03b,(short)0xf03a,(short)0xf039,(short)0xf038,(short)0xf037,(short)0xf036,(short)0xf035,(short)0xf034,(short)0xf033,(short)0xf032,(short)0xf031,(short)0xf030,(short)0xf02f,(short)0xf02e,(short)0xf02d,
  (short)0xf02c,(short)0xf02b,(short)0xf02b,(short)0xf02a,(short)0xf029,(short)0xf028,(short)0xf027,(short)0xf026,(short)0xf025,(short)0xf024,(short)0xf024,(short)0xf023,(short)0xf022,(short)0xf021,(short)0xf020,(short)0xf020,
  (short)0xf01f,(short)0xf01e,(short)0xf01d,(short)0xf01d,(short)0xf01c,(short)0xf01b,(short)0xf01a,(short)0xf01a,(short)0xf019,(short)0xf018,(short)0xf018,(short)0xf017,(short)0xf016,(short)0xf016,(short)0xf015,(short)0xf014,
  (short)0xf014,(short)0xf013,(short)0xf013,(short)0xf012,(short)0xf011,(short)0xf011,(short)0xf010,(short)0xf010,(short)0xf00f,(short)0xf00f,(short)0xf00e,(short)0xf00e,(short)0xf00d,(short)0xf00d,(short)0xf00c,(short)0xf00c,
  (short)0xf00b,(short)0xf00b,(short)0xf00a,(short)0xf00a,(short)0xf009,(short)0xf009,(short)0xf008,(short)0xf008,(short)0xf008,(short)0xf007,(short)0xf007,(short)0xf007,(short)0xf006,(short)0xf006,(short)0xf006,(short)0xf005,
  (short)0xf005,(short)0xf005,(short)0xf004,(short)0xf004,(short)0xf004,(short)0xf004,(short)0xf003,(short)0xf003,(short)0xf003,(short)0xf003,(short)0xf002,(short)0xf002,(short)0xf002,(short)0xf002,(short)0xf002,(short)0xf001,
  (short)0xf001,(short)0xf001,(short)0xf001,(short)0xf001,(short)0xf001,(short)0xf001,(short)0xf000,(short)0xf000,(short)0xf000,(short)0xf000,(short)0xf000,(short)0xf000,(short)0xf000,(short)0xf000,(short)0xf000,(short)0xf000 };


///@FIXME this function produces bad leaves.
void BSP_MarkVisibleLeaves_S(struct BSPTree* bsp, struct Camera* camera, struct _PolytopeList* polytopeList, unsigned long** drawot, int curTree, struct _Instance* savedLightInstance, struct _Terrain* terrain, struct GameTracker* gameTracker, struct _StreamUnit* currentUnit)
{
	//fp = drawot
	//s0 = bsp
	//s1 = curTree
	//s2 = saveLightInstance
	//s3 = curTree
	//s4 = terrain
	//s5 = gameTracker
	//s6 = camera
	//s7 = currentUnit

	//v0 = camera->core.farPlane

	///@WIN64 needs patching to uintptr_t
	getScratchAddr(0)[38] = (unsigned long)bsp;
	getScratchAddr(0)[39] = (unsigned long)curTree;
	getScratchAddr(0)[40] = (unsigned long)savedLightInstance;
	getScratchAddr(0)[41] = (unsigned long)curTree;
	getScratchAddr(0)[42] = (unsigned long)terrain;
	getScratchAddr(0)[43] = (unsigned long)gameTracker;
	getScratchAddr(0)[44] = (unsigned long)camera;
	getScratchAddr(0)[45] = (unsigned long)currentUnit;

	long s2 = depthQFogFar;
	//s4 = &getScratchAddr(0);

	//s5 = bsp
	//s6 = camera
	//fp = polytopeList

	unsigned long* s0 = getScratchAddr(48);
	s0[0] = (unsigned long)s0;

	unsigned long* s7 = (unsigned long*)&polytopeList->polytope;

	if (s2 >= camera->core.farPlane)
	{
		s2 = camera->core.farPlane;
	}
	//loc_80079520
	//v0 = &camera->core.vvNormalWorVecMat[0];
	//v1 = &getScratchAddr(0);
	//t0 = 64

	//loc_8007952C
	for(int i = 0; i < 4; i++)
	{
		unsigned int* pM = (unsigned int*)&camera->core.vvNormalWorVecMat[0].m[0][0];

		unsigned long* addr = &getScratchAddr(0)[0 + i];
		unsigned long* addr1 = &getScratchAddr(0)[1 + i];

		getScratchAddr(0)[0 + (i * 4)] = pM[0 + (i * 4)];
		getScratchAddr(0)[1 + (i * 4)] = pM[1 + (i * 4)];
		getScratchAddr(0)[2 + (i * 4)] = pM[2 + (i * 4)];
		getScratchAddr(0)[3 + (i * 4)] = pM[3 + (i * 4)];
	}

	gte_SetRotMatrix(getScratchAddr(0));
	gte_ldv0(&camera->core.position);///@FIXME not inited/updated so this code fails!!
	gte_rtv0();
	gte_stlvnl(getScratchAddr(24));

	gte_ldsvrtrow0(getScratchAddr(8));
	gte_ldsvrtrow1(getScratchAddr(10));
	gte_rtv0();

	gte_stmac(getScratchAddr(27), 1);
	gte_stmac(getScratchAddr(28), 2);

	((short*)getScratchAddr(0))[32] = camera->core.position.x;
	((short*)getScratchAddr(0))[33] = camera->core.position.y;
	((short*)getScratchAddr(0))[34] = camera->core.position.z;

	//t1 = camera->core.projDistance
	//t2 = camera->core.cwTransform2

	int v0 = (s2 << 15) / camera->core.projDistance;

	gte_ldw(1, s2);
	gte_SetRotMatrix(camera->core.cwTransform2);

	int t0 = (((camera->core.leftX - 160) * v0) >> 15) & 0xFFFF;
	int t1 = (((camera->core.topY - 120) * v0) << 1) & 0xFFFF0000;
	int t2 = (((camera->core.rightX - 160) * v0) >> 15) & 0xFFFF;
	int t3 = (((camera->core.bottomY - 120) * v0) << 1) & 0xFFFF0000;
	
	SVECTOR result;

	//v1 = 0xFFFF0000
	gte_ldw(0, t0 | t1);
	gte_rtv0();
	gte_stsv(&result);
	gte_ldw(0, t2 | t1);

	((short*)getScratchAddr(0))[35] = result.vx;
	((short*)getScratchAddr(0))[36] = result.vy;
	((short*)getScratchAddr(0))[37] = result.vz;

	gte_rtv0();
	gte_stsv(&result);
	gte_ldw(0, t2 | t3);

	((short*)getScratchAddr(0))[38] = result.vx;
	((short*)getScratchAddr(0))[39] = result.vy;
	((short*)getScratchAddr(0))[40] = result.vz;
	
	gte_rtv0();
	gte_stsv(&result);
	gte_ldw(0, t0 | t3);

	((short*)getScratchAddr(0))[58] = result.vx;
	((short*)getScratchAddr(0))[59] = result.vy;
	((short*)getScratchAddr(0))[60] = result.vz;

	gte_rtv0();
	gte_stsv(&result);

	((short*)getScratchAddr(0))[61] = result.vx;
	((short*)getScratchAddr(0))[62] = result.vy;
	((short*)getScratchAddr(0))[63] = result.vz;


	//t7 = gameTrackerX
	//v1 = gameTrackerX.gameData.asmData.MorphTime
	//v0 = gameTrackerX.gameData.asmData.MorphType
	//at = 0x3E8

	int a2 = 2;
	if (gameTrackerX.gameData.asmData.MorphTime == 1000 || 0 < 0)
	{
		if (gameTrackerX.gameData.asmData.MorphType == 0)
		{
			a2 = 0;
		}
		else
		{
			a2 = 1;
		}
	}
	
	//loc_80079764
	gte_SetRotMatrix(getScratchAddr(0));

	struct BSPTree* bspTree = bsp;//s5

	struct _BSPNode* bspRoot = bsp->bspRoot;//s1
	s0++;

	//loc_80079794
	do
	{
		s0--;

		gte_ldv0(&bspRoot->sphere.position.x);

		t0 = -bspRoot->sphere.radius;

		gte_rtv0();

		if (a2 == 2)
		{
			t0 -= 2048;
		}
		//loc_800797D4
		VECTOR v;//t1, t2, t3
		gte_stlvnl(&v);

		if (t0 < (v.vx - (int)getScratchAddr(0)[24]))
		{
			if (t0 < v.vy - (int)getScratchAddr(0)[25])
			{
				if (t0 < v.vz - (int)getScratchAddr(0)[26])
				{
					VECTOR v1;
					v1.vx = getScratchAddr(0)[8];
					v1.vy = getScratchAddr(0)[9];
					v1.vz = getScratchAddr(0)[10];

					gte_ldsvrtrow0(&v1.vx);
					gte_ldsvrtrow1(&v1.vz);

					gte_rtv0();

					int t4 = getScratchAddr(0)[27];
					int t5 = getScratchAddr(0)[28];

					gte_stmac(&t1, 1);
					gte_stmac(&t2, 2);

					v0 = t1 - t4;

					if (t0 < t1 - t4 && t0 < t2 - t5)
					{
						if ((bspRoot->flags & 0x1))
						{
							int* t44 = NULL;

							if (a2 == 0)
							{
								t44 = (int*)&bspRoot->front_material_error;
							}
							else
							{
								t44 = (int*)&bspRoot->front_spectral_error;
							}

							//loc_80079878
							t4 = t44[0];


							gte_SetRotMatrix(&getScratchAddr(0)[16]);

							gte_ldv0(&bspRoot->a);

							gte_rtv0();

							t5 = t4 >> 16;
							t4 <<= 16;
							t4 >>= 16;

							void* a3 = bspRoot->front;
							void* t9 = bspRoot->back;

							VECTOR v2;
							gte_stlvnl(&v2);

							t1 = v2.vx - bspRoot->d;
							t2 = v2.vy;
							t3 = v2.vz;

							if (t1 >= 0)
							{
								t0 = -t1;

								if (t9 != NULL)
								{
									if (t4 < t1 && t4 < t2 - t0 && t4 < t3 - t0)
									{
										gte_ldsvrtrow0(&getScratchAddr(0)[29]);
										gte_ldsvrtrow1(&getScratchAddr(0)[31]);

										gte_rtv0();

										gte_stmac(&t1, 1);
										gte_stmac(&t2, 2);

										if (t4 < t1 - t0 || t4 >= t2 - t0)
										{
											s0[1] = (unsigned long)t9;
											s0++;
										}
									}
									else
									{
										//loc_80079960
										s0[1] = (unsigned long)t9;
										s0++;
									}
								}

								//loc_80079968
								if (a3 != NULL)
								{
									s0[1] = (unsigned long)a3;
									s0++;

									if (0 < 0)
									{
										t0 = -t1;
										//loc_8007997C
										if (a3 != NULL)
										{
											if (t1 < t5 && t2 - t0 < t5 && t3 - t0 < t5)
											{
												gte_ldsvrtrow0(&getScratchAddr(0)[29]);
												gte_ldsvrtrow1(&getScratchAddr(0)[31]);

												gte_rtv0();

												gte_stmac(&t1, 1);
												gte_stmac(&t2, 2);

												if (t1 - t0 >= t5 && t2 - t0 >= t5)
												{
													s0[1] = (unsigned long)a3;
													s0++;
												}
												//loc_800799F0
											}
											else
											{
												//loc_800799F0
												s0[1] = (unsigned long)a3;
												s0++;
											}
										}
										//loc_800799F8

										if (t9 != NULL)
										{
											s0[1] = (unsigned long)t9;
											s0++;

											if (0 < 0)
											{
												s7[0] = (unsigned long)bspRoot;
												s7++;
											}
											//loc_80079A14
										}
										//loc_80079A14
									}
									//loc_80079A14
								}
								//loc_80079A14
							}
							else
							{
								//loc_8007997C
								t0 = -t1;
								if (a3 != NULL)
								{
									if (t1 < t5 && t2 - t0 < t5 && t3 - t0 < t5)
									{
										gte_ldsvrtrow0(&getScratchAddr(0)[29]);
										gte_ldsvrtrow1(&getScratchAddr(0)[31]);

										gte_rtv0();

										gte_stmac(&t1, 1);
										gte_stmac(&t2, 2);

										if (t1 - t0 >= t5 || t2 - t0 >= t5)
										{
											s0[1] = (unsigned long)a3;
											s0++;
										}
										//loc_800799F0
									}
									else
									{
										//loc_800799F0
										s0[1] = (unsigned long)a3;
										s0++;
									}
								}

								//loc_800799F8
								if (t9 != NULL)
								{
									s0[1] = (unsigned long)t9;
									s0++;

									if (0 < 0)
									{
										s7[0] = (unsigned long)bspRoot;
										s7++;
									}
									//loc_80079A14
								}
							}
						}
						else
						{
							//loc_80079A0C
							s7[0] = (unsigned long)bspRoot;
							s7++;
						}
					}
					//loc_80079A14
					gte_SetRotMatrix(&getScratchAddr(0)[0]);
				}
			}
		}
		//loc_80079A3C
		bspRoot = (struct _BSPNode*)s0[0];

	}while (bspRoot != (struct _BSPNode*)s0);

	polytopeList->numPolytopes = (((char*)s7 - (char*)polytopeList) - 4) >> 2;
}

void G2Quat_ToMatrix_S(struct _G2Quat_Type* quat, struct _G2Matrix_Type* matrix)
{
	int t6 = quat->x;
	int t9 = quat->w;
	int t7 = quat->y;
	int t8 = quat->z;

	int v0 = t6 << 1;

	IR0 = v0;
	IR1 = t6;
	IR2 = t9;
	IR3 = t7;

	gte_gpf12();

	int a0 = ONE;

	v0 = t7 << 1;

	int t0 = MAC1;
	int t1 = MAC2;
	int t2 = MAC3;

	IR0 = v0;
	IR1 = t7;
	IR2 = t9;
	IR3 = t8;

	gte_gpf12();

	v0 = t8 << 1;

	int t3 = MAC1;
	int t4 = MAC2;
	int t5 = MAC3;

	IR0 = v0;
	IR1 = t8;
	IR2 = t9;
	IR3 = t6;

	gte_gpf12();

	int v1 = t5 + t1;
	v0 = t0 + t3;
	v0 = a0 - v0;

	((short*)matrix)[7] = v1;
	((short*)matrix)[8] = v0;

	t6 = MAC1;
	t7 = MAC2;
	t8 = MAC3;

	v0 = t3 + t6;
	v0 = a0 - v0;
	v1 = t2 - t7;

	((short*)matrix)[0] = v0;
	((short*)matrix)[1] = v1;

	v0 = t8 + t4;
	v1 = t2 + t7;

	((short*)matrix)[2] = v0;
	((short*)matrix)[3] = v1;

	v0 = t0 + t6;
	v0 = a0 - v0;
	v1 = t5 - t1;

	((short*)matrix)[4] = v0;
	((short*)matrix)[5] = v1;

	v0 = t8 - t4;

	((short*)matrix)[6] = v0;
}

void G2Quat_FromEuler_S(struct _G2Quat_Type* quatInfo, struct _G2EulerAngles_Type* preQuat)
{
	int t0 = preQuat->x;
	int t2 = preQuat->y;
	int t4 = preQuat->z;

	int a1 = preQuat->order;

	//t8 = &ecostable
	int v1 = t0;

	if ((preQuat->order & 0x1))
	{
		t0 = t4;
		t4 = v1;
	}
	//loc_80079DB8
	t0 >>= 1;
	if ((preQuat->order & 0x4))
	{
		t2 = -t2;
	}
	//loc_80079DC8
	t2 >>= 1;
	t4 >>= 1;
	int t1 = t0 & 0x7FF;
	int t3 = t0 & 0x800;

	t0 = ecostable[t1];
	t1 = ecostable[t1 + 1024];

	if (t3 != 0)
	{
		t0 = -t0;
		t1 = -t1;
	}
	//loc_80079DF8

	t3 = t2 & 0x7FF;
	int t5 = t2 & 0x800;

	t2 = ecostable[t3];
	t3 = ecostable[t3 + 1024];

	if (t5 != 0)
	{
		t2 = -t2;
		t3 = -t3;
	}

	//loc_80079E20
	t5 = t4 & 0x7FF;
	int t8 = t4 & 0x800;

	t4 = ecostable[t5];
	t5 = ecostable[t5 + 1024];

	if (t8 != 0)
	{
		t4 = -t4;
		t5 = -t5;
	}

	IR0 = t1;
	IR1 = t5;
	IR2 = t4;

	gte_gpf12();

	int t6 = IR1;
	int t7 = IR2;
	
	IR0 = t0;
	IR1 = t5;
	IR2 = t4;

	gte_gpf12();

	v1 = (a1 & 0x18) >> 2;
	int v0 = a1 & 0x2;

	t8 = IR1;
	int t9 = IR2;

	t0 = t7 + t8;

	if (v0 != 0)
	{
		t5 = t6 - t9;

		IR0 = t3;
		IR1 = t0;
		IR2 = t5;

		gte_gpf0();

		a1 &= 0x4;
		a1 >>= 1;

		t1 = t6 + t9;
		t4 = t7 - t8;

		t0 = IR1;
		t5 = IR2;

		IR0 = t2;
		IR1 = t1;
		IR2 = t4;

		gte_gpf0();

		t8 = v1 + a1;

		t8 += 2;

		t9 = v1 - a1;
		if (t8 >= 5)
		{
			t8 -= 6;
		}

		t9 += 4;

		t1 = IR1;
		if (t9 >= 5)
		{
			t9 -= 6;
		}

		t4 = IR2;
	}
	else
	{
		//loc_80079F20
		IR0 = t3;
		IR1 = t8;
		IR2 = t9;
		IR3 = t7;

		t5 = t3 * t6;

		gte_gpf0();

		a1 &= 0x4;
		a1 >>= 1;

		t0 = MAC1;
		t1 = MAC2;
		t4 = MAC3;

		IR0 = t2;
		IR1 = t7;
		IR2 = t6;
		IR3 = t8;

		t7 = t2 * t9;

		gte_gpf0();

		t8 = v1 + a1;
		t8 += 2;

		t9 = v1 - a1;
		if (t8 >= 5)
		{
			t8 -= 6;
		}

		t9 += 4;
		t2 = MAC1;
		if (t9 >= 5)
		{
			t9 -= 6;
		}

		t3 = MAC2;
		t6 = MAC3;

		t0 -= t2;
		t1 += t3;
		t4 -= t6;
		t5 += t7;

		t0 >>= 12;
		t1 >>= 12;
		t4 >>= 12;
		t5 >>= 12;
	}

	//loc_80079FC8
	struct _G2Quat_Type* v11 = (struct _G2Quat_Type*)((char*)quatInfo + v1);
	struct _G2Quat_Type* t88 = (struct _G2Quat_Type*)((char*)quatInfo + t8);
	struct _G2Quat_Type* t99 = (struct _G2Quat_Type*)((char*)quatInfo + t9);

	if (a1 != 0)
	{
		t1 = -t1;
	}

	v11->x = t0;
	t88->x = t1;
	t99->x = t4;

	quatInfo->w = t5;
}

#if defined(PSXPC_VERSION) && defined(PSX_VERSION)
void RotMatrixX(long r, MATRIX* m)
{
	int v0;
	int v1;
	
	SVECTOR r1;
	SVECTOR r2;
	SVECTOR r3;
	SVECTOR r4;

	v0 = r & 0x7FF;

	v1 = ecostable[v0];
	v0 = ecostable[v0 + 1024];

	if ((r & 0x800))
	{
		v0 = -v0;
		v1 = -v1;
	}

	gte_lddp(v0);
	gte_ldsv(&m->m[1][0]);
	gte_gpf12();
	gte_stsv(&r1);

	gte_lddp(v1);
	gte_ldsv(&m->m[2][0]);
	gte_gpf12();
	gte_stsv(&r2);

	gte_ldsv(&m->m[1][0]);
	gte_gpf12();
	gte_stsv(&r3);

	r1.vx -= r2.vx;
	r1.vy -= r2.vy;
	r1.vz -= r2.vz;

	gte_lddp(v0);
	gte_ldsv(&m->m[2][0]);
	gte_gpf12();
	gte_stsv(&r4);

	m->m[1][0] = r1.vx;
	m->m[1][1] = r1.vy;
	m->m[1][2] = r1.vz;

	r3.vx += r4.vx;
	r3.vy += r4.vy;
	r3.vz += r4.vz;

	m->m[2][0] = r3.vx;
	m->m[2][1] = r3.vy;
	m->m[2][2] = r3.vz;

	return;
}

void RotMatrixY(long r, MATRIX* m)
{
	int v0;
	int v1;

	SVECTOR r1;
	SVECTOR r2;
	SVECTOR r3;
	SVECTOR r4;

	v0 = r & 0x7FF;

	v1 = ecostable[v0];
	v0 = ecostable[v0 + 1024];

	if ((r & 0x800))
	{
		v0 = -v0;
		v1 = -v1;
	}

	gte_lddp(v0);
	gte_ldsv(&m->m[0][0]);
	gte_gpf12();
	gte_stsv(&r1);

	gte_lddp(v1);
	gte_ldsv(&m->m[2][0]);
	gte_gpf12();
	gte_stsv(&r2);

	gte_ldsv(&m->m[0][0]);
	gte_gpf12();
	gte_stsv(&r3);

	r1.vx += r2.vx;
	r1.vy += r2.vy;
	r1.vz += r2.vz;

	gte_lddp(v0);
	gte_ldsv(&m->m[2][0]);
	gte_gpf12();
	gte_stsv(&r4);

	m->m[0][0] = r1.vx;
	m->m[0][1] = r1.vy;
	m->m[0][2] = r1.vz;

	r4.vx -= r3.vx;
	r4.vy -= r3.vy;
	r4.vz -= r3.vz;

	m->m[2][0] = r4.vx;
	m->m[2][1] = r4.vy;
	m->m[2][2] = r4.vz;

	return;
}

void RotMatrixZ(long r, MATRIX* m)
{
	int v0;
	int v1;

	SVECTOR r1;
	SVECTOR r2;
	SVECTOR r3;
	SVECTOR r4;

	v0 = r & 0x7FF;

	v1 = ecostable[v0];
	v0 = ecostable[v0 + 1024];

	if ((r & 0x800))
	{
		v0 = -v0;
		v1 = -v1;
	}

	gte_lddp(v0);
	gte_ldsv(&m->m[0][0]);
	gte_gpf12();
	gte_stsv(&r1);

	gte_lddp(v1);
	gte_ldsv(&m->m[1][0]);
	gte_gpf12();
	gte_stsv(&r2);

	gte_ldsv(&m->m[0][0]);
	gte_gpf12();
	gte_stsv(&r3);

	r1.vx -= r2.vx;
	r1.vy -= r2.vy;
	r1.vz -= r2.vz;

	gte_lddp(v0);
	gte_ldsv(&m->m[1][0]);
	gte_gpf12();
	gte_stsv(&r4);

	m->m[0][0] = r1.vx;
	m->m[0][1] = r1.vy;
	m->m[0][2] = r1.vz;

	r3.vx += r4.vx;
	r3.vy += r4.vy;
	r3.vz += r4.vz;

	m->m[1][0] = r3.vx;
	m->m[1][1] = r3.vy;
	m->m[1][2] = r3.vz;

	return;
}
#endif

short rsin(long a)
{
	int idx = a & 0x7FF;

	if ((a & 0x800))
	{
		return -ecostable[idx];
	}
	else
	{
		return ecostable[idx];
	}
}

short rcos(long a)
{
	int idx = a & 0x7FF;

	if ((a & 0x800))
	{
		return -ecostable[1024 + idx];
	}
	else
	{
		return ecostable[1024 + idx];
	}
}

long MATH3D_racos_S(long a)
{
	int v0 = 512;
	int t2 = 256;
	int t3 = a;

	if (a < 0)
	{
		t3 = -a;
	}

start:
	int t1 = ecostable[v0 + 1024];
	int t4 = 256;
	int t5 = t1 - t3;

	if (t5 != 0)
	{
		t2 >>= 1;

		if (t5 < 0)
		{
			t4 = -t4;
		}

		v0 += t4;

		if (t2 != 0)
		{
			goto start;
		}
	}

	if (a < 0)
	{
		v0 = 2048 - v0;
	}

	return v0;
}

void sub_80078458(struct _VMObject* vmobject, struct Level* level)
{
	struct _VMOffsetTable* currentVMOffset;//$a0
	struct _Terrain* terrain;//s7
	long dz;//s6
	struct _VMColorOffset* colorOffset;//$s4
	struct _VMOffset* moveOffset;//$s4
	long morphTime;
	long morphType;
	struct _MorphColor* morphColor;
	short t2;
	short v0;
	struct _VMOffset* move0;//t3
	struct _TVertex* vertex0;//t3
	struct _TVertex* bgv0;//t3
	struct _TVertex* bgv1;//t3
	struct _TVertex* bgv2;//t3
	struct _BGObject_Face* f;
	VECTOR color;
	CVECTOR rcolor;
	long color2;
	CVECTOR colOffset;
	unsigned char colRTemp;
	unsigned char colGTemp;
	int r;
	int g;
	int b;
	long i;//t1
	struct _BGObject* bgObject;
	struct _VMVertex* vmVertex;
	VECTOR vertex;
	SVECTOR sv;
	struct _VM_Face* vf;

	currentVMOffset = vmobject->curVMOffsetTable;
	terrain = level->terrain;

	dz = level->waterZLevel;

	if ((vmobject->flags & 0x10))
	{
		dz -= (terrain->BSPTreeArray + vmobject->bspIdx)->globalOffset.z;
	}
	//0x78490

	colorOffset = &currentVMOffset->offsets.colorOffsets;
	moveOffset = &currentVMOffset->offsets.moveOffsets;
	
	if ((vmobject->flags & 0x4))
	{
		if (vmobject->numVMVertices != 0)
		{
			if (vmobject->numVMVertices == 0x14)
			{
				int testing = 0;
				testing++;
			}

			morphTime = gameTrackerX.gameData.asmData.MorphTime;
			morphType = gameTrackerX.gameData.asmData.MorphType;

			if (morphTime != 1000)
			{
				morphTime = (morphTime * 4096) / 1000;

				if (morphTime == 0)
				{
					morphTime = 1;
				}

				if (morphType != 0)
				{
					morphTime = 4096 - morphTime;
				}

				morphColor = level->terrain->MorphColorList;

				if (0 < 0)
				{
					morphTime = 0;

					if (morphType != 0)
					{
						morphColor = level->terrain->MorphColorList;
					}
				}
			}
			else
			{
				//0x78524
				morphTime = 0;

				if (morphType != 0)
				{
					morphColor = level->terrain->MorphColorList;
				}
			}

			//0x78534
			for (i = 0; i < vmobject->numVMVertices; i++)
			{
				vmVertex = (struct _VMVertex*)vmobject->vmvertexList + i;

				t2 = vmVertex->timer + vmobject->timer;
				v0 = vmVertex->count;

				if (t2 >= currentVMOffset->numVMOffsets)
				{
					t2 -= currentVMOffset->numVMOffsets;
				}

				vertex0 = &level->terrain->vertexList[v0];

				if (morphTime != 0)
				{
					gte_lddp(morphTime);

					color.vx = ((((morphColor + v0)->morphColor15 & 0x1F) << 3) - ((vertex0->rgb15 & 0x1F) << 3)) << 4;
					color.vy = ((((morphColor + v0)->morphColor15 & 0x3E0) >> 2) - ((vertex0->rgb15 & 0x3E0) >> 2)) << 4;
					color.vz = ((((morphColor + v0)->morphColor15 & 0x7C00) >> 7) - ((vertex0->rgb15 & 0x7C00) >> 7)) << 4;

					gte_ldcv(((long*)&color));

					MAC1 = ((vertex0->rgb15 & 0x1F) << 3) << 4;
					MAC2 = ((vertex0->rgb15 & 0x3E0) >> 2) << 4;
					MAC3 = ((vertex0->rgb15 & 0x7C00) >> 7) << 4;

					gte_gpl12();

					gte_strgb(&rcolor);//t4, t5, t6

					if (0 < 0)
					{
						if (morphTime != 0)
						{
							color2 = (morphColor + v0)->morphColor15;

							if (0 < 0)
							{
								color2 = vertex0->rgb15;
							}
						}
						else
						{
							//0x7862C
							color2 = vertex0->rgb15;
						}

						rcolor.r = (color2 & 0x1F) << 3;
						rcolor.g = (color2 & 0x3E0) >> 2;
						rcolor.b = (color2 & 0x7C00) >> 7;
					}
				}
				else
				{
					if (morphType != 0)
					{
						color2 = (morphColor + v0)->morphColor15;

						if (0 < 0)
						{
							color2 = vertex0->rgb15;
						}
					}
					else
					{
						//0x7862C
						color2 = vertex0->rgb15;
					}

					rcolor.r = (color2 & 0x1F) << 3;//t4
					rcolor.g = (color2 & 0x3E0) >> 2;//t5
					rcolor.b = (color2 & 0x7C00) >> 7;//t6
				}

				//0x7864C
				colOffset.r = colorOffset[t2].dr;//t7
				colOffset.g = colorOffset[t2].dg;//t8
				colOffset.b = colorOffset[t2].db;//t9

				//v1 = vertex->vertex.z;

				if ((vmobject->flags & 0x10) && dz < vertex0->vertex.z)
				{
					colOffset.r = 0;
					colOffset.b = 0;
					colOffset.g = 0;
				}
				//0x7868C

				if (morphType != 0 && morphTime == 0 && (vmobject->flags & 0x100))
				{
					colRTemp = colOffset.r;
					colOffset.r = colOffset.g;
					colOffset.g = colRTemp;
				}

				r = rcolor.r + colOffset.r;//t4 + t7
				g = rcolor.g + colOffset.g;//t5 + t8
				b = rcolor.b + colOffset.b;//t6 + t9

				if ((r & 0xFF00) != 0)
				{
					if (r < 0)
					{
						r = 0;
					}
					else
					{
						r = 255;
					}
				}

				//0x786C8
				if ((g & 0xFF00) != 0)
				{
					if (g < 0)
					{
						g = 0;
					}
					else
					{
						g = 255;
					}
				}

				if ((b & 0xFF00) != 0)
				{
					if (b < 0)
					{
						b = 0;
					}
					else
					{
						b = 255;
					}
				}

				vertex0->r0 = r;
				vertex0->g0 = g;
				vertex0->b0 = b;
			}
		}
		//0x7870C

		//t1 = level->numBGObjects
		//t0 = 
		f = (struct _BGObject_Face*)level->bgObjectList;

		for (i = level->numBGObjects; i != 0; i--)
		{
			bgv0 = &level->terrain->vertexList[f[i].v1];//s4
			bgv1 = &level->terrain->vertexList[f[i].v2];//s5

			vertex.vx = bgv1->vertex.x - bgv0->vertex.x;
			vertex.vy = bgv1->vertex.y - bgv0->vertex.y;
			vertex.vz = bgv1->vertex.z - bgv0->vertex.z;

			gte_lddp(f->unknown2);
			gte_ldcv(((long*)&vertex));
			gte_gpf12();

			bgv2 = &level->terrain->vertexList[f[i].v0];//s5

			gte_stsv(&sv);//t7, t8, t9

			//bgv2->vertex.x = bgv0->vertex.x + sv.vx;
			//bgv2->vertex.y = bgv0->vertex.y + sv.vy;
			//bgv2->vertex.z = bgv0->vertex.z + sv.vz;
		}

		if (0 >= 0)
		{
			return;
		}
	}
	//0x787F4
	if ((vmobject->flags & 0x8))
	{
		for (i = 0; i < vmobject->numVMVertices; i++)
		{
			vf = (struct _VM_Face*)vmobject->vmvertexList + i;

			int t2 = vf->v4 + vmobject->timer;

			if (t2 >= currentVMOffset->numVMOffsets)
			{
				t2 -= currentVMOffset->numVMOffsets;
			}

			int t4 = vf->v1;
			int t5 = vf->v2;
			int t6 = vf->v3;

			vertex0 = &level->terrain->vertexList[vf->v0];//t3
			move0 = &moveOffset[t2];//t2

			vertex0->vertex.x = t4 + move0->dx;
			vertex0->vertex.y = t5 + move0->dy;
			vertex0->vertex.z = t6 + move0->dz;
		}
		//0x78878
		//t1 = level->numBGObjects

		for(i = level->numBGObjects; i != 0; i--)
		{
			bgv0 = &level->terrain->vertexList[((struct _BGObject_Face*)&level->bgObjectList[i])->v1];//s4
			bgv1 = &level->terrain->vertexList[((struct _BGObject_Face*)&level->bgObjectList[i])->v2];//s5

			vertex.vx = bgv1->vertex.x - bgv0->vertex.x;
			vertex.vy = bgv1->vertex.y - bgv0->vertex.y;
			vertex.vz = bgv1->vertex.z - bgv0->vertex.z;

			gte_lddp(((struct _BGObject_Face*)&level->bgObjectList[i])->unknown2);
			gte_ldcv(((long*)&vertex));
			gte_gpf12();

			bgv2 = &level->terrain->vertexList[((struct _BGObject_Face*)&level->bgObjectList[i])->v0];//t3

			gte_stsv(&sv);//t7, t8, t9

			bgv2->vertex.x = bgv0->vertex.x + sv.vx;
			bgv2->vertex.y = bgv0->vertex.y + sv.vy;
			bgv2->vertex.z = bgv0->vertex.z + sv.vz;
		}
		//0x78948
	}
	//0x78948
}


void VM_ProcessVMObjectList_S(struct Level* level, struct Camera* camera)
{
	long timer;
	long i;

	for(i = 0; i < level->numVMObjects; i++)
	{
		if (!(level->vmobjectList[i].flags & 0x2))
		{
			timer = level->vmobjectList[i].timer + 1;

			if (timer >= level->vmobjectList[i].curVMOffsetTable->numVMOffsets)
			{
				timer = 0;
			}

			level->vmobjectList[i].timer = timer;

			//if (BSP_SphereIntersectsViewVolume_S(&level->vmobjectList[i].position) != 0)
			{
				sub_80078458(&level->vmobjectList[i], level);
			}
		}
	}
}

long BSP_SphereIntersectsViewVolume_S(struct _Position* position)
{
	UNIMPLEMENTED();
	return 0;
}

#if defined(PSXPC_VERSION) && defined(PSX_VERSION)
MATRIX* RotMatrixZYX(SVECTOR* r, MATRIX* m)
{
	int t9 = r->vz;
	int t8 = r->vy;
	int t7 = r->vx;

	int t0 = t9 & 0x7FF;
	int t5 = ecostable[t0];
	int t2 = ecostable[t0 + 1024];
	int t3 = t9 & 0x800;

	if (t3 != 0)
	{
		t5 = -t5;
		t2 = -t2;
	}

	int t4 = t8 | t7;
	int t1;
	int t6;
	int a0;

	if (t4 != 0)
	{
		t0 = t8 & 0x7FF;
		t4 = ecostable[t0];
		t1 = ecostable[t0 + 1024];
		t3 = t8 & 0x800;

		if (t3 != 0)
		{
			t1 = -t1;
			t4 = -t4;
		}

		t0 = t7 & 0x7FF;
		t3 = ecostable[t0];
		t0 = ecostable[t0 + 1024];
		
		t6 = t7 & 0x800;

		if (t6 != 0)
		{
			t3 = -t3;
			t0 = -t0;
		}

		IR1 = t1;
		IR2 = t2;
		IR3 = t5;

		IR0 = t0;

		int v0 = (t1 * t2) >> 12;

		gte_gpf12();

		m->m[2][0] = -t4;

		t6 = IR2;
		a0 = IR1;
		t7 = IR3;

		m->m[2][2] = a0;

		IR1 = t1;
		IR2 = t2;
		IR3 = t5;

		IR0 = t3;

		gte_gpf12();

		m->m[0][0] = v0;

		v0 = (t1 * t5) >> 12;

		a0 = IR1;
		t8 = IR2;
		t9 = IR3;

		m->m[2][1] = a0;

		IR1 = t6;
		IR2 = t7;
		IR3 = t8;

		IR0 = t4;

		gte_gpf12();

		m->m[1][0] = v0;

		v0 = (t9 * t4) >> 12;

		a0 = IR1;
		t0 = IR2;
		t1 = IR3;

		t2 = t1 - t7;
		t3 = a0 + t9;
		t4 = v0 + t6;
		t5 = t0 - t8;

		m->m[0][1] = t2;
		m->m[0][2] = t3;
		m->m[1][1] = t4;
		m->m[1][2] = t5;
	}
	else
	{
		t5 <<= 16;
		t0 = -t5;
		t1 = t2 & 0xFFFF;
		t0 |= t1;
		t3 = 4096;

		((int*)m)[0] = t0;
		((int*)m)[1] = t5;
		((int*)m)[2] = t1;
		((int*)m)[3] = 0;
		((int*)m)[4] = t3;
	}

	return m;
}
#endif
