#include "Game/CORE.H"
#include "ANMCTRLR.H"
#include "POOLMMG2.H"
#include "ANIMG2.H"
#include "Game/PSX/COLLIDES.H"


void G2Anim_AttachControllerToSeg(struct _G2Anim_Type *anim, int segNumber, int type)
{
	_G2AnimController_InsertIntoList(_G2AnimController_Create(segNumber, type), &anim->controllerList);
}


// autogenerated function stub: 
// void /*$ra*/ G2Anim_DetachControllerFromSeg(struct _G2Anim_Type *anim /*$s1*/, int segNumber /*$s2*/, int type /*$s3*/)
void G2Anim_DetachControllerFromSeg(struct _G2Anim_Type *anim, int segNumber, int type)
{ // line 260, offset 0x80090350
	/* begin block 1 */
		// Start line: 261
		// Start offset: 0x80090350
		// Variables:
			//struct _G2AnimController_Type *controller; // $v0
			unsigned short *controllerNextPtr; // stack offset -32
	/* end block 1 */
	// End offset: 0x800903FC
	// End Line: 291

	/* begin block 2 */
		// Start line: 530
	/* end block 2 */
	// End Line: 531
			UNIMPLEMENTED();
}

void G2Anim_EnableController(struct _G2Anim_Type* anim, int segNumber, int type)
{
	struct _G2AnimController_Type* controller;
	struct _G2Matrix_Type* segMatrix;
	
	controller = _G2AnimControllerST_RemoveFromList(segNumber, type, &anim->disabledControllerList);

	if (controller != NULL)
	{
		controller->duration = 0;

		controller->elapsedTime = 0;

		controller->flags = (unsigned char)controller->flags;

		if (controller->type == 8)
		{
			G2EulerAngles_ToMatrix_S(controller->data.quat.dest, &anim->segMatrices[segNumber]);

			_G2AnimController_InsertIntoList(controller, &anim->controllerList);
		}
		else if (controller->type == 0x20)
		{
			segMatrix = &anim->segMatrices[segNumber];

			controller->data.quat.src.x = (unsigned short)segMatrix->trans.x;
			controller->data.quat.src.y = (unsigned short)segMatrix->trans.y;
			controller->data.quat.src.z = (unsigned short)segMatrix->trans.z;

			_G2AnimController_InsertIntoList(controller, &anim->controllerList);
		}
		else
		{
			memset(&controller->data.quat.src, 0, sizeof(struct _G2Quat_Type) * 2);
		}
	}
}

void G2Anim_DisableController(struct _G2Anim_Type* anim, int segNumber, int type)
{ 
	struct _G2AnimController_Type* controller;

	controller = _G2AnimControllerST_RemoveFromList(segNumber, type, &anim->controllerList);

	if (controller != NULL)
	{
		_G2AnimController_InsertIntoList(controller, &anim->disabledControllerList);
	}
}


// autogenerated function stub: 
// void /*$ra*/ G2Anim_InterpDisableController(struct _G2Anim_Type *anim /*$s2*/, int segNumber /*$s4*/, int type /*$s3*/, short duration /*$s5*/)
void G2Anim_InterpDisableController(struct _G2Anim_Type *anim, int segNumber, int type, short duration)
{ // line 430, offset 0x80090534
	/* begin block 1 */
		// Start line: 431
		// Start offset: 0x80090534
		// Variables:
			//struct _G2AnimController_Type *controller; // $s1
			//struct _G2SVector3_Type zeroVector; // stack offset -48
			struct _G2Quat_Type targetQuat; // stack offset -40
	/* end block 1 */
	// End offset: 0x80090630
	// End Line: 475

	/* begin block 2 */
		// Start line: 860
	/* end block 2 */
	// End Line: 861
			UNIMPLEMENTED();
}

enum _G2Bool_Enum G2Anim_IsControllerActive(struct _G2Anim_Type* anim, int segNumber, int type)//Matching - 99.74%
{
	struct _G2AnimController_Type* controller;

	controller = _G2AnimControllerST_FindInList(segNumber, type, &anim->controllerList);

	if (controller == NULL)
	{
		return (enum _G2Bool_Enum)0;
	}

	return (enum _G2Bool_Enum)((controller->flags & 0x8000) < 0x8000);
}


// autogenerated function stub: 
// enum _G2Bool_Enum /*$ra*/ G2Anim_IsControllerInterpolating(struct _G2Anim_Type *anim /*$a0*/, int segNumber /*$a1*/, int type /*$a2*/)
enum _G2Bool_Enum G2Anim_IsControllerInterpolating(struct _G2Anim_Type *anim, int segNumber, int type)
{ // line 519, offset 0x800906a0
	/* begin block 1 */
		// Start line: 520
		// Start offset: 0x800906A0
		// Variables:
			//struct _G2AnimController_Type *controller; // $v0
	/* end block 1 */
	// End offset: 0x800906E4
	// End Line: 540

	/* begin block 2 */
		// Start line: 987
	/* end block 2 */
	// End Line: 988
	UNIMPLEMENTED();
	return (_G2Bool_Enum)0;
}


// autogenerated function stub: 
// void /*$ra*/ G2Anim_GetControllerCurrentInterpVector(struct _G2Anim_Type *anim /*$s1*/, int segNumber /*$a1*/, int type /*$a2*/, //struct _G2SVector3_Type *vector /*$s0*/)
void G2Anim_GetControllerCurrentInterpVector(struct _G2Anim_Type *anim, int segNumber, int type, struct _G2SVector3_Type *vector)
{ // line 558, offset 0x800906f4
	/* begin block 1 */
		// Start line: 559
		// Start offset: 0x800906F4
		// Variables:
			//struct _G2AnimController_Type *controller; // $v1
			//struct _G2SVector3_Type *base; // $a0
			//struct _G2SVector3_Type *offset; // $a1
			struct _G2Matrix_Type *segMatrix; // $v1

		/* begin block 1.1 */
			// Start line: 579
			// Start offset: 0x80090738
			// Variables:
				//struct _G2SVector3_Type *source; // $a0
				//struct _G2SVector3_Type *dest; // $s0

			/* begin block 1.1.1 */
				// Start line: 579
				// Start offset: 0x80090738
				// Variables:
					unsigned short z; // $v1
					unsigned long xy; // $v0
			/* end block 1.1.1 */
			// End offset: 0x80090738
			// End Line: 579
		/* end block 1.1 */
		// End offset: 0x80090738
		// End Line: 579

		/* begin block 1.2 */
			// Start line: 580
			// Start offset: 0x8009074C
			// Variables:
				//struct _G2SVector3_Type *dest; // $s0
				//struct _G2SVector3_Type *base; // $a0
				//struct _G2SVector3_Type *offset; // $a1
				long alpha; // $v0
		/* end block 1.2 */
		// End offset: 0x8009074C
		// End Line: 580
	/* end block 1 */
	// End offset: 0x80090840
	// End Line: 603

	/* begin block 2 */
		// Start line: 1116
	/* end block 2 */
	// End Line: 1117
				UNIMPLEMENTED();
}

void G2Anim_SetControllerCallbackData(struct _G2Anim_Type* anim, int segNumber, int type, void* callbackData)
{
	_G2Anim_FindController(anim, segNumber, type)->callbackData = callbackData;
}

void G2Anim_SetControllerAngleOrder(struct _G2Anim_Type* anim, int segNumber, int type, int order)
{
	struct _G2AnimController_Type* controller;

	controller = _G2Anim_FindController(anim, segNumber, type);

	controller->flags &= 0xFF00;
	controller->flags |= order;
}

void G2Anim_SetController_Vector(struct _G2Anim_Type* anim, int segNumber, int type, struct _G2SVector3_Type* vector)
{
	struct _G2AnimController_Type* controller;

	controller = _G2Anim_FindController(anim, segNumber, type);

	controller->data.vector.base.x = vector->x;
	controller->data.vector.base.y = vector->y;
	controller->data.vector.base.z = vector->z;

	controller->flags = (unsigned char)controller->flags;
}


// autogenerated function stub: 
// void /*$ra*/ G2Anim_SetInterpController_Vector(struct _G2Anim_Type *anim /*$s2*/, int segNumber /*$s3*/, int type /*$s4*/, //struct _G2SVector3_Type *vector /*$s6*/, int duration /*stack 16*/)
void G2Anim_SetInterpController_Vector(struct _G2Anim_Type *anim, int segNumber, int type, struct _G2SVector3_Type *vector, int duration)
{ // line 711, offset 0x800908fc
	/* begin block 1 */
		// Start line: 712
		// Start offset: 0x800908FC
		// Variables:
			//struct _G2AnimController_Type *controller; // $s1
			struct _G2EulerAngles_Type eulerVector; // stack offset -48
			//struct _G2SVector3_Type *base; // $s0
			//struct _G2SVector3_Type *offset; // $a1
			struct _G2Quat_Type quat; // stack offset -40
	/* end block 1 */
	// End offset: 0x80090A38
	// End Line: 753

	/* begin block 2 */
		// Start line: 1422
	/* end block 2 */
	// End Line: 1423
			UNIMPLEMENTED();
}


// autogenerated function stub: 
// void /*$ra*/ G2Anim_SetInterpController_Quat(struct _G2Anim_Type *anim /*$s1*/, int segNumber /*$a1*/, int type /*$a2*/, struct _G2Quat_Type *quat /*$s2*/, int duration /*stack 16*/)
void G2Anim_SetInterpController_Quat(struct _G2Anim_Type *anim, int segNumber, int type, struct _G2Quat_Type *quat, int duration)
{ // line 780, offset 0x80090a60
	/* begin block 1 */
		// Start line: 781
		// Start offset: 0x80090A60
		// Variables:
			//struct _G2AnimController_Type *controller; // $s0

		/* begin block 1.1 */
			// Start line: 781
			// Start offset: 0x80090A60
			// Variables:
				struct _G2Quat_Type *source; // $s2

			/* begin block 1.1.1 */
				// Start line: 781
				// Start offset: 0x80090A60
				// Variables:
					unsigned long zw; // $a0
					unsigned long xy; // $v1
			/* end block 1.1.1 */
			// End offset: 0x80090A60
			// End Line: 781
		/* end block 1.1 */
		// End offset: 0x80090A60
		// End Line: 781
	/* end block 1 */
	// End offset: 0x80090A60
	// End Line: 781

	/* begin block 2 */
		// Start line: 1560
	/* end block 2 */
	// End Line: 1561
					UNIMPLEMENTED();

}


// autogenerated function stub: 
// void /*$ra*/ _G2Anim_ApplyControllersToStoredFrame(struct _G2Anim_Type *anim /*$s2*/)
void _G2Anim_ApplyControllersToStoredFrame(struct _G2Anim_Type *anim)
{ // line 810, offset 0x80090adc
	/* begin block 1 */
		// Start line: 811
		// Start offset: 0x80090ADC
		// Variables:
			int i; // $s0
	/* end block 1 */
	// End offset: 0x80090B24
	// End Line: 820

	/* begin block 2 */
		// Start line: 1487
	/* end block 2 */
	// End Line: 1488
			UNIMPLEMENTED();

}


// autogenerated function stub: 
// void /*$ra*/ _G2Anim_BuildTransformsWithControllers(struct _G2Anim_Type *anim /*$s6*/)
void _G2Anim_BuildTransformsWithControllers(struct _G2Anim_Type *anim)
{ // line 824, offset 0x80090b3c
	/* begin block 1 */
		// Start line: 825
		// Start offset: 0x80090B3C
		// Variables:
			struct _Segment *segment; // $a1
			//struct _G2AnimController_Type *controller; // $s0
			struct _G2Matrix_Type *segMatrix; // $s5
			struct _G2Matrix_Type *parentMatrix; // $a1
			enum _G2Bool_Enum bRootTransUpdated; // $a3
			int segIndex; // $s1
			int segCount; // $s7
			unsigned long disabledBits[3]; // stack offset -56
			unsigned long disabledMask; // $s3
			unsigned long parentMask; // $v1
			unsigned long parentIndex; // $v0
	/* end block 1 */
	// End offset: 0x80090CE4
	// End Line: 910

	/* begin block 2 */
		// Start line: 1516
	/* end block 2 */
	// End Line: 1517
			UNIMPLEMENTED();

}


// autogenerated function stub: 
// void /*$ra*/ _G2Anim_BuildSegTransformWithControllers(struct _G2Matrix_Type *segMatrix /*$s2*/, struct _G2Matrix_Type *parentMatrix /*$s4*/, //struct _G2AnimController_Type *controller /*$s0*/, enum _G2Bool_Enum bRootTransUpdated /*$s6*/, int segIndex /*stack 16*/)
void _G2Anim_BuildSegTransformWithControllers(struct _G2Matrix_Type *segMatrix, struct _G2Matrix_Type *parentMatrix, struct _G2AnimController_Type *controller, enum _G2Bool_Enum bRootTransUpdated, int segIndex)
{ // line 919, offset 0x80090d1c
	/* begin block 1 */
		// Start line: 920
		// Start offset: 0x80090D1C
		// Variables:
			struct _G2AnimSegValue_Type *segValue; // $s1
			struct _G2LVector3_Type scale; // stack offset -48
			unsigned long flags; // $s3

		/* begin block 1.1 */
			// Start line: 977
			// Start offset: 0x80090F20
			// Variables:
				//struct _G2SVector3_Type *svector; // $v0
				struct _G2LVector3_Type *lvector; // $v1
		/* end block 1.1 */
		// End offset: 0x80090F20
		// End Line: 977
	/* end block 1 */
	// End offset: 0x80090FC4
	// End Line: 1004

	/* begin block 2 */
		// Start line: 1885
	/* end block 2 */
	// End Line: 1886
				UNIMPLEMENTED();

}


// autogenerated function stub: 
// unsigned long /*$ra*/ _G2AnimController_ApplyToSegValue(//struct _G2AnimController_Type *controller /*$a0*/, struct _G2AnimSegValue_Type *segValue /*$s0*/, struct _G2Matrix_Type *segMatrix /*$s3*/, struct _G2Matrix_Type *parentMatrix /*$s2*/)
unsigned long _G2AnimController_ApplyToSegValue(struct _G2AnimController_Type *controller, struct _G2AnimSegValue_Type *segValue, struct _G2Matrix_Type *segMatrix, struct _G2Matrix_Type *parentMatrix)
{ // line 1014, offset 0x80091028
	/* begin block 1 */
		// Start line: 1015
		// Start offset: 0x80091028
		// Variables:
			struct _G2Matrix_Type tempMatrix; // stack offset -64
			//struct _G2SVector3_Type tempVector; // stack offset -32
			unsigned long flags; // $s1

		/* begin block 1.1 */
			// Start line: 1063
			// Start offset: 0x800912A4

			/* begin block 1.1.1 */
				// Start line: 1063
				// Start offset: 0x800912A4
				// Variables:
					unsigned short z; // $v1
					unsigned long xy; // $v0
			/* end block 1.1.1 */
			// End offset: 0x800912A4
			// End Line: 1063
		/* end block 1.1 */
		// End offset: 0x800912A4
		// End Line: 1063

		/* begin block 1.2 */
			// Start line: 1081
			// Start offset: 0x80091350

			/* begin block 1.2.1 */
				// Start line: 1081
				// Start offset: 0x80091350
				// Variables:
					//unsigned short z; // $v1
					//unsigned long xy; // $v0
			/* end block 1.2.1 */
			// End offset: 0x80091350
			// End Line: 1081
		/* end block 1.2 */
		// End offset: 0x80091350
		// End Line: 1081
	/* end block 1 */
	// End offset: 0x800913B4
	// End Line: 1097

	/* begin block 2 */
		// Start line: 2097
	/* end block 2 */
	// End Line: 2098
					UNIMPLEMENTED();

	return 0;
}


// autogenerated function stub: 
// void /*$ra*/ _G2Anim_UpdateControllers(struct _G2Anim_Type *anim /*$s1*/)
void _G2Anim_UpdateControllers(struct _G2Anim_Type *anim)
{ // line 1101, offset 0x800913d0
	/* begin block 1 */
		// Start line: 1102
		// Start offset: 0x800913D0
		// Variables:
			//struct _G2AnimController_Type *controller; // $s0
			struct _G2AnimSection_Type *section; // $v1
			short elapsedTime; // $s2
	/* end block 1 */
	// End offset: 0x80091544
	// End Line: 1151

	/* begin block 2 */
		// Start line: 2271
	/* end block 2 */
	// End Line: 2272
			UNIMPLEMENTED();

}


// autogenerated function stub: 
// void /*$ra*/ _G2Anim_CopyVectorWithOrder(//struct _G2SVector3_Type *sourceVector /*$a0*/, struct _G2EulerAngles_Type *destVector /*$a1*/, int order /*$a2*/)
void _G2Anim_CopyVectorWithOrder(struct _G2SVector3_Type *sourceVector, struct _G2EulerAngles_Type *destVector, int order)
{ // line 1157, offset 0x8009155c
	/* begin block 1 */
		// Start line: 2387
	/* end block 1 */
	// End Line: 2388

	/* begin block 2 */
		// Start line: 2390
	/* end block 2 */
	// End Line: 2391
	UNIMPLEMENTED();

}


// autogenerated function stub: 
// void /*$ra*/ _G2AnimSection_ApplyControllersToStoredFrame(struct _G2AnimSection_Type *section /*$s3*/)
void _G2AnimSection_ApplyControllersToStoredFrame(struct _G2AnimSection_Type *section)
{ // line 1181, offset 0x800915c0
	/* begin block 1 */
		// Start line: 1182
		// Start offset: 0x800915C0
		// Variables:
			struct _G2Anim_Type *anim; // $s7
			//struct _G2AnimController_Type *controller; // $s0
			struct _G2AnimSegValue_Type *segValue; // $s1
			struct _Segment *segment; // $s6
			struct _G2Matrix_Type segMatrix; // stack offset -152
			struct _G2Matrix_Type parentMatrix; // stack offset -120
			struct _G2Matrix_Type invParentMatrix; // stack offset -88
			struct _G2EulerAngles_Type eulerAngles; // stack offset -56
			int segIndex; // $s2
			int segCount; // $fp

		/* begin block 1.1 */
			// Start line: 1237
			// Start offset: 0x80091760
			// Variables:
				struct _G2Quat_Type tempQuat; // stack offset -48

			/* begin block 1.1.1 */
				// Start line: 1239
				// Start offset: 0x80091760
				// Variables:
					struct _G2Quat_Type *dest; // $s1

				/* begin block 1.1.1.1 */
					// Start line: 1239
					// Start offset: 0x80091760
					// Variables:
						unsigned long zw; // $v1
						//unsigned long xy; // $v0
				/* end block 1.1.1.1 */
				// End offset: 0x80091760
				// End Line: 1239
			/* end block 1.1.1 */
			// End offset: 0x80091760
			// End Line: 1239
		/* end block 1.1 */
		// End offset: 0x80091760
		// End Line: 1239

		/* begin block 1.2 */
			// Start line: 1242
			// Start offset: 0x8009177C
			// Variables:
				//struct _G2SVector3_Type *dest; // $s1

			/* begin block 1.2.1 */
				// Start line: 1242
				// Start offset: 0x8009177C
				// Variables:
					unsigned long mask; // $v0
					unsigned short z; // $v1
					unsigned long xy; // $a0
			/* end block 1.2.1 */
			// End offset: 0x8009177C
			// End Line: 1242
		/* end block 1.2 */
		// End offset: 0x8009177C
		// End Line: 1242
	/* end block 1 */
	// End offset: 0x80091804
	// End Line: 1260

	/* begin block 2 */
		// Start line: 2436
	/* end block 2 */
	// End Line: 2437
					UNIMPLEMENTED();

}


// autogenerated function stub: 
// unsigned long /*$ra*/ _G2AnimController_ApplyWorldToParentMatrix(//struct _G2AnimController_Type *controller /*$a0*/, struct _G2Matrix_Type *parentMatrix /*$s0*/)
unsigned long _G2AnimController_ApplyWorldToParentMatrix(struct _G2AnimController_Type *controller, struct _G2Matrix_Type *parentMatrix)
{ // line 1265, offset 0x80091834
	/* begin block 1 */
		// Start line: 1266
		// Start offset: 0x80091834
		// Variables:
			struct _G2Matrix_Type tempMatrix; // stack offset -64
			//struct _G2SVector3_Type tempSVector; // stack offset -32
			struct _G2LVector3_Type tempLVector; // stack offset -24
	/* end block 1 */
	// End offset: 0x80091974
	// End Line: 1317

	/* begin block 2 */
		// Start line: 2618
	/* end block 2 */
	// End Line: 2619
			UNIMPLEMENTED();

	return 0;
}


// autogenerated function stub: 
// void /*$ra*/ _G2AnimController_GetMatrix(//struct _G2AnimController_Type *controller /*$s0*/, struct _G2Matrix_Type *matrix /*$s1*/)
void _G2AnimController_GetMatrix(struct _G2AnimController_Type *controller, struct _G2Matrix_Type *matrix)
{ // line 1325, offset 0x80091988
	/* begin block 1 */
		// Start line: 1326
		// Start offset: 0x80091988
		// Variables:
			struct _G2Quat_Type tempQuat; // stack offset -24
	/* end block 1 */
	// End offset: 0x80091A4C
	// End Line: 1376

	/* begin block 2 */
		// Start line: 2747
	/* end block 2 */
	// End Line: 2748
			UNIMPLEMENTED();

}


// autogenerated function stub: 
// void /*$ra*/ _G2AnimController_GetVector(//struct _G2AnimController_Type *controller /*$a0*/, //struct _G2SVector3_Type *vector /*$a1*/)
void _G2AnimController_GetVector(struct _G2AnimController_Type *controller, struct _G2SVector3_Type *vector)
{ // line 1381, offset 0x80091a60
	/* begin block 1 */
		// Start line: 1384
		// Start offset: 0x80091A60

		/* begin block 1.1 */
			// Start line: 1384
			// Start offset: 0x80091A60
			// Variables:
				//struct _G2SVector3_Type *dest; // $a1

			/* begin block 1.1.1 */
				// Start line: 1384
				// Start offset: 0x80091A60
				// Variables:
					unsigned short z; // $v1
					unsigned long xy; // $v0
			/* end block 1.1.1 */
			// End offset: 0x80091A60
			// End Line: 1384
		/* end block 1.1 */
		// End offset: 0x80091A60
		// End Line: 1384

		/* begin block 1.2 */
			// Start line: 1389
			// Start offset: 0x80091A84
			// Variables:
				//struct _G2SVector3_Type *dest; // $a1
				//struct _G2SVector3_Type *base; // $a1
				//struct _G2SVector3_Type *offset; // $v0
				long alpha; // $v1
		/* end block 1.2 */
		// End offset: 0x80091AE0
		// End Line: 1389
	/* end block 1 */
	// End offset: 0x80091AE0
	// End Line: 1394

	/* begin block 2 */
		// Start line: 2859
	/* end block 2 */
	// End Line: 2860

	/* begin block 3 */
		// Start line: 2861
	/* end block 3 */
	// End Line: 2862
				UNIMPLEMENTED();

}

struct _G2AnimController_Type* _G2Anim_FindController(struct _G2Anim_Type* anim, int segNumber, int type)
{
	struct _G2AnimController_Type* controller;
	
	controller = _G2AnimControllerST_FindInList(segNumber, type, &anim->controllerList);

	if (controller == NULL)
	{
		controller = _G2AnimControllerST_FindInList(segNumber, type, &anim->disabledControllerList);
	}

	return controller;
}

struct _G2AnimController_Type* _G2AnimController_Create(int segNumber, int type)
{
	struct _G2AnimController_Type* controller;
	
	controller = (struct _G2AnimController_Type*)G2PoolMem_Allocate(&_controllerPool);

	memset(controller, 0, sizeof(struct _G2AnimController_Type));

	controller->next = 0;
	controller->segNumber = segNumber;
	controller->type = type;
	controller->flags = 0x15;

	return controller;
}


// autogenerated function stub: 
// //struct _G2AnimController_Type * /*$ra*/ _G2AnimController_Destroy(//struct _G2AnimController_Type *controller /*$a1*/)
struct _G2AnimController_Type * _G2AnimController_Destroy(struct _G2AnimController_Type *controller)
{ // line 1499, offset 0x80091bac
	/* begin block 1 */
		// Start line: 1502
		// Start offset: 0x80091BBC
		// Variables:
			int nextControllerIndex; // $s0
	/* end block 1 */
	// End offset: 0x80091BFC
	// End Line: 1515

	/* begin block 2 */
		// Start line: 3046
	/* end block 2 */
	// End Line: 3047
			UNIMPLEMENTED();
	return null;
}

void _G2AnimController_InsertIntoList(struct _G2AnimController_Type* controller, unsigned short* listPtr)//Matching - 91.64%
{
	struct _G2AnimController_Type* testController;

	testController = &_controllerPool.blockPool[listPtr[0]];

	while (_controllerPool.blockPool < testController)
	{
		if ((controller->segNumber >= testController->segNumber) && ((testController->segNumber != controller->segNumber) || (controller->type >= testController->type)))
		{
			listPtr = (unsigned short*)testController;
			testController = &_controllerPool.blockPool[testController->next];
		}
		else
		{
			break;
		}
	}

	listPtr[0] = ((controller - _controllerPool.blockPool));

	do
	{
		listPtr = (unsigned short*)controller;
		controller = &_controllerPool.blockPool[listPtr[0]];

	} while (_controllerPool.blockPool < controller);

	listPtr[0] = ((testController - _controllerPool.blockPool));
}



// autogenerated function stub: 
// void /*$ra*/ _G2AnimController_GetCurrentInterpQuat(//struct _G2AnimController_Type *controller /*$s0*/, struct _G2Anim_Type *anim /*$a3*/, struct _G2Quat_Type *quat /*$s1*/)
void _G2AnimController_GetCurrentInterpQuat(struct _G2AnimController_Type *controller, struct _G2Anim_Type *anim, struct _G2Quat_Type *quat)
{ // line 1560, offset 0x80091d40
	/* begin block 1 */
		// Start line: 1561
		// Start offset: 0x80091D40
		// Variables:
			struct _G2EulerAngles_Type eulerVector; // stack offset -24

		/* begin block 1.1 */
			// Start line: 1591
			// Start offset: 0x80091E18
			// Variables:
				//struct _G2Quat_Type *quat; // $s1
		/* end block 1.1 */
		// End offset: 0x80091E18
		// End Line: 1591
	/* end block 1 */
	// End offset: 0x80091E68
	// End Line: 1609

	/* begin block 2 */
		// Start line: 3170
	/* end block 2 */
	// End Line: 3171
			UNIMPLEMENTED();

}


// autogenerated function stub: 
// void /*$ra*/ _G2AnimController_GetSimpleWorldRotQuat(//struct _G2AnimController_Type *controller /*$a0*/, struct _G2Anim_Type *anim /*$a3*/, struct _G2Quat_Type *quat /*$s1*/)
void _G2AnimController_GetSimpleWorldRotQuat(struct _G2AnimController_Type *controller, struct _G2Anim_Type *anim, struct _G2Quat_Type *quat)
{ // line 1615, offset 0x80091e7c
	/* begin block 1 */
		// Start line: 1616
		// Start offset: 0x80091E7C
		// Variables:
			struct _Segment *segment; // $v0
			struct _G2Matrix_Type *parentMatrix; // $s0
			struct _G2Matrix_Type segMatrix; // stack offset -48
			int segNumber; // $v0
	/* end block 1 */
	// End offset: 0x80091E7C
	// End Line: 1616

	/* begin block 2 */
		// Start line: 3280
	/* end block 2 */
	// End Line: 3281
			UNIMPLEMENTED();

}

struct _G2AnimController_Type* _G2AnimControllerST_FindInList(int segNumber, int type, unsigned short* listPtr)
{
	struct _G2AnimController_Type* controller;

	while (_controllerPool.blockPool < (controller = &_controllerPool.blockPool[listPtr[0]]))
	{
		if (controller->segNumber != segNumber || controller->type != type)
		{
			controller = &_controllerPool.blockPool[controller->next];
			listPtr = (unsigned short*)controller;
		}
		else
		{
			return controller;
		}
	}

	return NULL;
}


// autogenerated function stub: 
// //struct _G2AnimController_Type * /*$ra*/ _G2AnimControllerST_FindPtrInList(int segNumber /*$a0*/, int type /*$a1*/, unsigned short **listPtrPtr /*$a2*/)
struct _G2AnimController_Type * _G2AnimControllerST_FindPtrInList(int segNumber, int type, unsigned short **listPtrPtr)
{ // line 1669, offset 0x80091f6c
	/* begin block 1 */
		// Start line: 1672
		// Start offset: 0x80091F6C
		// Variables:
			//struct _G2AnimController_Type *controller; // $a3
	/* end block 1 */
	// End offset: 0x80091FFC
	// End Line: 1693

	/* begin block 2 */
		// Start line: 3416
	/* end block 2 */
	// End Line: 3417

	/* begin block 3 */
		// Start line: 3418
	/* end block 3 */
	// End Line: 3419

	/* begin block 4 */
		// Start line: 3423
	/* end block 4 */
	// End Line: 3424
	UNIMPLEMENTED();
	return null;
}

struct _G2AnimController_Type* _G2AnimControllerST_RemoveFromList(int segNumber, int type, unsigned short* listPtr)//Matching - 83.37%
{
	struct _G2AnimController_Type* controller;
	struct _G2AnimController_Type* stepController;
	struct _G2AnimController_Type* nextController;

	if ((controller = &_controllerPool.blockPool[listPtr[0]]) > _controllerPool.blockPool)
	{
		while ((controller = &_controllerPool.blockPool[listPtr[0]]) > _controllerPool.blockPool)
		{
			if (controller->segNumber != segNumber || controller->type != type)
			{
				nextController = controller;

				listPtr = (unsigned short*)controller;

				controller = &_controllerPool.blockPool[listPtr[0]];
			}
			else
			{
				break;
			}
		}

		nextController = controller;
		while (nextController > _controllerPool.blockPool)
		{
			stepController = nextController;
			nextController = &_controllerPool.blockPool[nextController->next];

			listPtr[0] = stepController->next;

			if (nextController <= _controllerPool.blockPool || nextController->type != 0)
			{
				stepController->next = 0;

				return controller;
			}
		}
	}
	return NULL;
}